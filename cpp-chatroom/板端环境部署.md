## 首先是 gstreamer & opencv3.4.15 & librknnrt.so

无网络环境的版本
创建打包内容并生成 tar（先把 HOST_SYSROOT、USB_MOUNT、BUNDLE 按实际路径调整）

注意 file 一下文件确保不是坏链，小心只复制了符号链接
```bash
set -e
export HOST_SYSROOT=/home/circlemoon/sysroots/rk3566
export STAGING=/home/circlemoon/exports/opencv-rknn-bundle
export USB_MOUNT=/media/$USER/USB   # 改成你的 U 盘挂载点
export BUNDLE=/home/circlemoon/exports/opencv-rknn-rk3566-$(date +%Y%m%d).tar

rm -rf "$STAGING"
mkdir -p "$STAGING"/{opencv/lib,opencv/share,rknn/lib,rknn/include}

rsync -a "$HOST_SYSROOT"/usr/lib/libopencv_{core,imgproc,imgcodecs,videoio,highgui}.so* "$STAGING/opencv/lib/"
rsync -a "$HOST_SYSROOT"/usr/share/OpenCV "$STAGING/opencv/share/"
rsync -a "$HOST_SYSROOT"/usr/lib/pkgconfig/opencv.pc "$STAGING/opencv/"

rsync -aL "$HOST_SYSROOT"/usr/lib/librknnrt.so* "$STAGING/rknn/lib/"
rsync -a "$HOST_SYSROOT"/usr/include/rknn "$STAGING/rknn/include/"

tar -C "$STAGING" -cpf "$BUNDLE" .
cp "$BUNDLE" "$USB_MOUNT/"
sync
```
板端离线部署（U 盘插入后执行）
假设 U 盘挂载到 /media/<user>/USB，选择一个临时目录解压：
```bash
set -e
export USB_MOUNT=/media/$USER/USB
export STAGING=/opt/rk3566-sync

sudo mkdir -p "$STAGING"
sudo tar -xpf "$USB_MOUNT/opencv-rknn-rk3566-YYYYMMDD.tar" -C "$STAGING"   # 日期按实际文件名替换

echo '/usr/local/lib' | sudo tee /etc/ld.so.conf.d/local-opencv-rknn.conf >/dev/null
sudo rsync -a "$STAGING/opencv/lib/" /usr/local/lib/
sudo rsync -a "$STAGING/opencv/share/" /usr/local/share/
sudo install -m 644 "$STAGING/opencv/opencv.pc" /usr/local/lib/pkgconfig/opencv.pc
sudo rsync -a "$STAGING/rknn/lib/" /usr/local/lib/
sudo rsync -a "$STAGING/rknn/include/" /usr/local/include/

sudo ldconfig
ldconfig -p | grep -E 'opencv|rknn'
```

有网络环境的版本
```bash
set -e

# 1. 定义开发机信息（请修改 IP）
export HOST_USER=circlemoon
export HOST_IP=192.168.x.x
export HOST_SYSROOT=/home/circlemoon/sysroots/rk3566
export STAGING=/tmp/pc-sync
mkdir -p $STAGING/opencv/lib $STAGING/opencv/share $STAGING/rknn/lib $STAGING/rknn/include

# 2. 从开发机拉取 OpenCV 3.4.15 运行时文件
rsync -avz ${HOST_USER}@${HOST_IP}:${HOST_SYSROOT}/usr/lib/libopencv_{core,imgproc,imgcodecs,videoio,highgui}.so* $STAGING/opencv/lib/
rsync -avz ${HOST_USER}@${HOST_IP}:${HOST_SYSROOT}/usr/share/OpenCV $STAGING/opencv/share/
rsync -avz ${HOST_USER}@${HOST_IP}:${HOST_SYSROOT}/usr/lib/pkgconfig/opencv.pc $STAGING/opencv/

# 3. 拉取 RKNN Runtime
rsync -avz ${HOST_USER}@${HOST_IP}:${HOST_SYSROOT}/usr/lib/librknnrt.so* $STAGING/rknn/lib/
rsync -avz ${HOST_USER}@${HOST_IP}:${HOST_SYSROOT}/usr/include/rknn $STAGING/rknn/include/

# 4. 安装到板端系统
echo '/usr/local/lib' | sudo tee /etc/ld.so.conf.d/local-opencv-rknn.conf >/dev/null
sudo rsync -a $STAGING/opencv/lib/ /usr/local/lib/
sudo rsync -a $STAGING/opencv/share/ /usr/local/share/
sudo install -m 644 $STAGING/opencv/opencv.pc /usr/local/lib/pkgconfig/opencv.pc
sudo rsync -a $STAGING/rknn/lib/ /usr/local/lib/
sudo rsync -a $STAGING/rknn/include/ /usr/local/include/

# 5. 刷新动态库缓存并校验
sudo ldconfig
ldconfig -p | grep -E 'opencv|rknn'
```

## 然后是 my_kylin_led_driver.ko & dtb

