# RK3566 äº¤å‰ç¼–è¯‘é—®é¢˜æ’æŸ¥è®°å½•

## äº¤å‰ç¼–è¯‘å‡†å¤‡æŒ‡å—

æœ¬æŒ‡å—å¸®åŠ©ä½ åœ¨ **WSL ç¯å¢ƒ** ä¸­åŒæ—¶ä¸ºä¸¤ç±»ç›®æ ‡å¹³å°å‡†å¤‡äº¤å‰ç¼–è¯‘ç¯å¢ƒï¼š

- Windows 10/11 x64
- RK3566ï¼ˆKylin Ubuntuï¼‰

### 3. é¢å‘ RK3566ï¼ˆKylin Ubuntuï¼‰

#### 3.1 æ“ä½œæ€»è§ˆ

- æ¿ç«¯ç¡®è®¤ Qt è¿è¡Œåº“å®Œæ•´ï¼Œå¹¶å¯¼å‡ºåŒ¹é…çš„ sysrootã€‚
- åœ¨ WSL å‡†å¤‡äº¤å‰å·¥å…·é“¾ã€è§£å‹ sysrootï¼Œè¡¥å…… Qt CMake é…ç½®ä¸ glibc startfilesã€‚
- æ ¹æ®éœ€è¦ï¼ˆå¤ç”¨æˆ–è‡ªå»ºï¼‰å‡†å¤‡ Qt 5.12.8 aarch64ã€‚
- ä½¿ç”¨å·¥å…·é“¾æ–‡ä»¶é…ç½® CMakeï¼Œç”Ÿæˆ `FeiQChatroom` çš„ aarch64 å¯æ‰§è¡Œæ–‡ä»¶ã€‚
- å›ä¼ å¯æ‰§è¡Œæ–‡ä»¶åŠä¾èµ–åº“åˆ°æ¿ç«¯éªŒè¯è¿è¡Œã€‚

#### 3.2 æ¿ç«¯å‡†å¤‡

**Qt è¿è¡Œåº“æ ¸å¯¹**

- `ldconfig -p | grep Qt5`ï¼šç¡®è®¤ `libQt5Core.so.5`ã€`libQt5Gui.so.5`ã€`libQt5Widgets.so.5`ã€`libQt5Network.so.5` å‡å­˜åœ¨ã€‚
- å¦‚ç¼ºå¤±ï¼Œå¯å®‰è£…å‘è¡Œç‰ˆè¿è¡Œæ—¶åŒ…ï¼ˆç¤ºä¾‹ï¼‰` sudo apt install libqt5core5a libqt5gui5 libqt5widgets5 libqt5network5`
- `qmake -v` æˆ– `strings libQt5Core.so.5 | grep "Qt "` æ£€æŸ¥ç‰ˆæœ¬ï¼›`ls -l /usr/lib/aarch64-linux-gnu/libQt5Core.so*` æ ¡éªŒç¬¦å·é“¾æ¥ã€‚
- `ldd /opt/feiqlab/FeiQChatroom | grep Qt5` å¯éªŒè¯å·²æœ‰ç¨‹åºè¿è¡Œä¾èµ–ã€‚

**é‡‡é›† sysroot**

- **æ— ç½‘ç»œ**ï¼šåœ¨æ¿ç«¯æ‰§è¡Œ

  ```bash
  sudo tar -cpf /tmp/rk3566-sysroot-$(date +%Y%m%d).tar \
      --numeric-owner --xattrs --acls \
      -C / \
      usr lib etc/ld.so.conf etc/ld.so.conf.d etc/ld.so.cache
  ```

  å°† tar åŒ…æ‹·è´åˆ° U ç›˜ï¼Œè¿åŒæ ¡éªŒå€¼ `sha256sum /tmp/rk3566-sysroot-*.tar`ã€‚
- **æœ‰ç½‘ç»œ**ï¼š`rsync -a root@<board-ip>:/usr/ ...`ã€`rsync -a root@<board-ip>:/lib/ ...`ã€‚
- **å¤ç”¨ SDK é•œåƒèƒŒæ™¯**ï¼šåœ¨å†³å®šä»æ¿ç«¯ç¦»çº¿æ‰“åŒ… sysroot ä¹‹å‰ï¼Œä¼˜å…ˆå°è¯•äº†ä½¿ç”¨ SDK æä¾›çš„ `rootfs.img`ã€‚

1. åˆ›å»ºæŒ‚è½½ç‚¹ä¸ç›®æ ‡ç›®å½•

```bash
  mkdir -p /home/circlemoon/sysroots/rk3566-rootfs-mnt
  mkdir -p /home/circlemoon/sysroots/rk3566
```

2. æŒ‚è½½ rootfs é•œåƒ

```bash
  sudo mount -o loop \
    /home/circlemoon/SDK/firefly_rk3588_SDK/prebuilt_rootfs/Ubuntu20.04.3LTS_Firefly_202510071336_rootfs.img \
    /home/circlemoon/sysroots/rk3566-rootfs-mnt
```

3. åŒæ­¥å†…å®¹åˆ° sysroot

```bash
  sudo rsync -aHAX --delete \
    /home/circlemoon/sysroots/rk3566-rootfs-mnt/ \
    /home/circlemoon/sysroots/rk3566/
```

4. å¸è½½é•œåƒå¹¶æ¸…ç†æŒ‚è½½ç‚¹

```bash
  sudo umount /home/circlemoon/sysroots/rk3566-rootfs-mnt
  rmdir /home/circlemoon/sysroots/rk3566-rootfs-mnt
```

* **ç—‡çŠ¶**ï¼š`cmake -S . -B build-rk3566 ...` ç«‹å³æŠ¥é”™ï¼Œ`CMakeLists.txt:13 (find_package)` å¤±è´¥ï¼Œæç¤º `Could not find a package configuration file provided by "Qt5"`ã€‚
* **è°ƒæŸ¥ä¸å¤±è´¥å°è¯•**ï¼š
  1. `find $RK3566_SYSROOT -name "Qt5Config.cmake"` æœªæ‰¾åˆ°ä»»ä½•æ–‡ä»¶ã€‚
  2. **å°è¯•ä¿®å¤ 1**ï¼šä» SDK çš„å…¶ä»–ç›®å½•ï¼ˆé `rootfs.img`ï¼‰é›¶æ˜ŸæŸ¥æ‰¾ï¼Œè¯•å›¾æ‰¾åˆ° `.cmake` æ–‡ä»¶å¹¶ `rsync` è¿› sysrootã€‚
  3. **å¤±è´¥**ï¼šå³ä½¿æ‰¾åˆ°äº†éƒ¨åˆ†æ–‡ä»¶ï¼Œé©¬ä¸ŠåˆæŠ¥ç¼ºå°‘ EGL é©±åŠ¨ï¼ˆå¦‚ `libEGL.so`ï¼‰ã€Mali åº“æˆ– `moc`/`rcc` ç­‰å·¥å…·ã€‚
  4. **å°è¯•ä¿®å¤ 2**ï¼šæ‰‹åŠ¨å¤åˆ¶ `qt5/bin` ç›®å½•ï¼Œä½†è¿™äº›æ˜¯ ARM ç‰ˆ ELFï¼Œå¯¼è‡´äº†åç»­çš„ "Host å·¥å…·æ— æ³•æ‰§è¡Œ" é—®é¢˜ã€‚
* **æœ€ç»ˆåˆ†æä¸å†³ç­–**ï¼š
  * **æ ¹å› **ï¼šSDK æä¾›çš„ `rootfs.img` æ˜¯ä¸€ä¸ª**è¿è¡Œæ—¶ (Runtime) é•œåƒ**ï¼Œå®ƒåªåŒ…å«è¿è¡Œç¨‹åºæ‰€éœ€çš„åŠ¨æ€åº“ï¼ˆå¦‚ `libQt5Core.so.5`ï¼‰ï¼Œè€Œä¸åŒ…å«**å¼€å‘ (Development)** æ‰€éœ€çš„å¤´æ–‡ä»¶ (`.h`)ã€CMake é…ç½®æ–‡ä»¶ (`.cmake`) æˆ– `pkgconfig` (`.pc`) æ–‡ä»¶ã€‚è¿™äº›å¼€å‘æ–‡ä»¶é€šå¸¸åœ¨ `qtbase5-dev` ç­‰ `-dev` åŒ…ä¸­ã€‚
  * **æœ€ä¼˜æ–¹æ³•**ï¼šæ”¾å¼ƒä¿®è¡¥ SDK é•œåƒã€‚æœ€å¯é ä¸”æœ€ç®€å•çš„æ–¹æ³•æ˜¯ï¼š**åœ¨ç›®æ ‡æ¿ä¸Š `apt install` æ‰€æœ‰å¿…éœ€çš„ `-dev` åŒ…ï¼ˆå¦‚ `qtbase5-dev`, `libsqlite3-dev`ï¼‰ï¼Œç„¶åä»è¯¥æ¿ä¸Šå®Œæ•´å¯¼å‡º sysroot**ã€‚è¿™ç¡®ä¿äº† sysroot ä¸ç›®æ ‡ç¯å¢ƒ 100% ä¸€è‡´ã€‚

å¦‚æœä»æ¿å­ç«¯é‡æ–°æ‹·è´ä¸€éƒ¨åˆ†æ–‡ä»¶æ¥è¡¥æ•‘ï¼Œè¯·ç¡®ä¿åŒæ­¥æ—¶åŒ…å« `/usr/lib/aarch64-linux-gnu/cmake/Qt5*`ã€`/usr/lib/aarch64-linux-gnu/crt*.o` ç­‰å…³é”®æ–‡ä»¶ã€‚

> ğŸ“ é‡‡é›† sysroot æ—¶åˆ‡å‹¿ä»…æ‹·è´ `qt5/` æˆ–é€šç”¨ include ç›®å½•ã€‚Qtã€Mali EGLã€SQLite ç­‰å¤šæ¶æ„èµ„æºå…¨éƒ¨æ”¾åœ¨ `usr/lib/aarch64-linux-gnu/`ã€`usr/include/aarch64-linux-gnu/`ã€`usr/lib/aarch64-linux-gnu/cmake/` ä¸ `usr/lib/aarch64-linux-gnu/pkgconfig/` ä¸‹ï¼Œç¼ºå¤±è¿™äº›ç›®å½•ä¼šå¯¼è‡´åç»­ `find_package(Qt5)`ã€é“¾æ¥ `libEGL.so`ã€ç¼–è¯‘ `sqlite3` ç­‰æ­¥éª¤å…¨éƒ¨å¤±è´¥ã€‚

#### 3.3 WSL ç«¯å‡†å¤‡

**å®‰è£…å·¥å…·é“¾ä¸å¸¸ç”¨å·¥å…·**

```bash
sudo apt update
sudo apt install build-essential cmake ninja-build pkg-config rsync \
    gcc-aarch64-linux-gnu g++-aarch64-linux-gnu
```

> ğŸ“Œ å®æµ‹ Firefly SDK è‡ªå¸¦çš„ `aarch64-none-linux-gnu-g++` ä¾èµ– glibc 2.33ï¼Œä¼šä¸æ¿ç«¯ 2.31 å†²çªå¹¶è§¦å‘ `GLIBC_2.33` é“¾æ¥é”™è¯¯ã€‚æœ¬æµç¨‹ç»Ÿä¸€ä½¿ç”¨ç³»ç»Ÿäº¤å‰ç¼–è¯‘å™¨ï¼ˆ9.3/9.4ï¼‰ã€‚

**å¯¼å…¥ sysroot**

```bash
sudo mkdir -p /home/circlemoon/sysroots/rk3566
sudo tar -xpf /mnt/d/exports/rk3566-sysroot-*.tar \
  -C /home/circlemoon/sysroots/rk3566   # æ ¹æ®å®é™…è·¯å¾„æ›¿æ¢
```

åŒæ­¥å®Œæˆåï¼š

- `ls -l /home/circlemoon/sysroots/rk3566/usr/lib/aarch64-linux-gnu/libQt5Core.so*`ã€`.../libQt5Gui.so*` æ£€æŸ¥ Qt åº“ã€‚
- `ls /home/circlemoon/sysroots/rk3566` åº”èƒ½çœ‹åˆ°å®Œæ•´ rootfs ç»“æ„ï¼ˆç¤ºä¾‹ï¼š`bin/ boot/ dev/ etc/ lib/ media/ opt/ root/ sbin/ sys/ tmp/ usr/ var/`ï¼‰ã€‚
- è‹¥ `cmake/Qt5` ç›®å½•ç¼ºå¤±ï¼Œä»æ¿ç«¯æˆ–é•œåƒå•ç‹¬ `rsync` è¿‡æ¥ã€‚
- å¦‚æœé“¾æ¥æ—¶æŠ¥ `crt1.o`/`crti.o` ç¼ºå¤±ï¼Œç¡®è®¤ `usr/lib/aarch64-linux-gnu/crt*.o` å­˜åœ¨ï¼Œå¹¶æ‰§è¡Œï¼š
  ```bash
  sudo cp usr/lib/aarch64-linux-gnu/crt*.o usr/lib/
  sudo ln -s aarch64-linux-gnu usr/lib/aarch64-none-linux-gnu
  ```

**ç¯å¢ƒè„šæœ¬**ï¼ˆ`env/setup-rk3566.sh`ï¼‰

```bash
#!/bin/bash
export RK3566_SDK=/home/circlemoon/SDK/firefly_rk3588_SDK
export RK3566_TOOLCHAIN=/usr
export RK3566_PREFIX=aarch64-linux-gnu
export RK3566_SYSROOT=/home/circlemoon/sysroots/rk3566

export PATH=/usr/bin:$PATH
export PKG_CONFIG_SYSROOT_DIR=$RK3566_SYSROOT
export PKG_CONFIG_LIBDIR=$RK3566_SYSROOT/usr/lib/pkgconfig:\
    $RK3566_SYSROOT/usr/share/pkgconfig:\
    $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/pkgconfig
```

ä½¿ç”¨å‰æ‰§è¡Œ `source env/setup-rk3566.sh`ã€‚

#### 3.4 CMake å·¥å…·é“¾æ–‡ä»¶

`cmake/toolchains/rk3566.cmake`

```cmake
set(CMAKE_SYSTEM_NAME Linux)
set(CMAKE_SYSTEM_PROCESSOR aarch64)

if(NOT DEFINED ENV{RK3566_SYSROOT})
  message(FATAL_ERROR "è¯·å…ˆ source env/setup-rk3566.sh")
endif()

set(RK3566_SYSROOT $ENV{RK3566_SYSROOT})
if(DEFINED ENV{RK3566_PREFIX})
  set(RK3566_PREFIX $ENV{RK3566_PREFIX})
else()
  set(RK3566_PREFIX aarch64-linux-gnu)
endif()

set(CMAKE_SYSROOT ${RK3566_SYSROOT})
set(CMAKE_C_COMPILER ${RK3566_PREFIX}-gcc)
set(CMAKE_CXX_COMPILER ${RK3566_PREFIX}-g++)

set(CMAKE_C_FLAGS_INIT "--sysroot=${CMAKE_SYSROOT}")
set(CMAKE_CXX_FLAGS_INIT "--sysroot=${CMAKE_SYSROOT}")

set(CMAKE_FIND_ROOT_PATH ${CMAKE_SYSROOT})
set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)
```

#### 3.5 Qt å¯ç”¨æ€§

- **å¤ç”¨æ¿ç«¯ Qt**ï¼šç¡®ä¿ sysroot åŒ…å« `Qt5Config.cmake`ï¼Œå¹¶å°† `CMAKE_PREFIX_PATH` æŒ‡å‘ `â€¦/usr/lib/aarch64-linux-gnu/cmake`ã€‚
- **è‡ªè¡Œäº¤å‰ç¼–è¯‘**ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‰éœ€åœ¨ WSL å†…å¯¹ Qt 5.12.8 æºç æ‰§è¡Œ

  ```bash
  /opt/qt-src-5.12.8/configure \
      -prefix /opt/qt-5.12.8-rk3566 \
      -opensource -confirm-license \
      -release \
      -platform linux-g++-64 \
  -device-option CROSS_COMPILE=aarch64-linux-gnu- \
  -sysroot $RK3566_SYSROOT \
      -nomake tests -nomake examples \
      -skip qtwebengine
  ```

  ç¼–è¯‘ååœ¨ `CMAKE_PREFIX_PATH` ä¸­ä½¿ç”¨ `/opt/qt-5.12.8-rk3566/lib/cmake/Qt5`ã€‚

å¦‚æœå‡ºç°æŠ¥é”™å°±æ˜¯å› ä¸ºå½“å‰ sysroot é‡Œç¼ºå°‘ Qt çš„ CMake é…ç½®ï¼ˆ`Qt5Config.cmake` ç­‰ï¼‰ã€‚æ—¢ç„¶æ¿å­ä¸Šåæ¥æ‰å®‰è£…äº† `qmake/qtbase5-dev`ï¼ŒåŸå…ˆæå–çš„ rootfs é‡Œè‚¯å®šæ²¡æœ‰è¿™äº›æ–‡ä»¶ã€‚æ— éœ€é‡æ–°æ‹·å®Œæ•´ä¸ª sysrootï¼Œåªè¦æŠŠ Qt ç›¸å…³çš„ â€œå¼€å‘â€ éƒ¨åˆ†è¡¥é½å³å¯ã€‚

æ¿ç«¯æ“ä½œ

1. åœ¨æ¿å­ä¸Šä¸´æ—¶æ”¶é›†è¦åŒæ­¥çš„ç›®å½•ï¼ˆåŒ…å« CMake é…ç½®ã€åº“ã€å¤´æ–‡ä»¶ã€pkg-config ä»¥åŠ mkspecsï¼‰ï¼š

```bash
   sudo mkdir -p /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/cmake
   sudo mkdir -p /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/pkgconfig

   sudo mkdir -p /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/qt5/bin
   sudo mkdir -p /tmp/qt5-dev-sync/usr/include/aarch64-linux-gnu

   sudo rsync -a /usr/lib/aarch64-linux-gnu/cmake/Qt5* /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/cmake/
   sudo rsync -a /usr/lib/aarch64-linux-gnu/libQt5*.so* /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/
   sudo rsync -a /usr/lib/aarch64-linux-gnu/pkgconfig/Qt5*.pc /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/pkgconfig/

   # Qt å¤´æ–‡ä»¶ä¸ mkspecs çš„å®é™…ä½ç½®å¯èƒ½å› å‘è¡Œç‰ˆè€Œå¼‚

      pkg-config --variable=includedir Qt5Core
      pkg-config --variable=mkspecsdir Qt5Core
      sudo rsync -a /usr/include/aarch64-linux-gnu/qt5/ 
       /tmp/qt5-dev-sync/usr/include/aarch64-linux-gnu/qt5/
      sudo rsync -a /usr/lib/aarch64-linux-gnu/qt5/mkspecs/
       /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/qt5/mkspecs/
      sudo rsync -a /usr/lib/aarch64-linux-gnu/qt5/bin/qmake
       /tmp/qt5-dev-sync/usr/lib/aarch64-linux-gnu/qt5/bin/
```

2. æ‰“åŒ…æ–¹ä¾¿æ‹·è´ï¼š

```
sudo tar -cpf /tmp/qt5-rk3566-dev.tar \
       --numeric-owner --xattrs --acls \
       -C /tmp/qt5-dev-sync .
```

3. å°† `/tmp/qt5-rk3566-dev.tar` å¤åˆ¶åˆ° U ç›˜æˆ–å…¶ä»–ä»‹è´¨ï¼ˆå¦‚æœæœ‰ SSHï¼Œä¹Ÿå¯ä»¥ç”¨ `scp`ï¼‰ã€‚

WSLï¼šåˆå…¥ç°æœ‰ sysroot

1. æ‹·è´ tar åŒ…åˆ° WSL åï¼Œè§£åŒ…åˆ° sysroot æ ¹ç›®å½•ï¼ˆå‡è®¾å·²ä½¿ç”¨ `/home/circlemoon/sysroots/rk3566`ï¼‰ï¼š

```bash
  # å¦‚æ­¤å‰åŒæ­¥åˆ°äº†é”™è¯¯ç›®å½•ï¼Œå¯å…ˆæ¸…ç†æ—§å†…å®¹é¿å…å¹²æ‰°ï¼š
  sudo rm -rf /home/circlemoon/sysroots/rk3566/usr/include/qt5
  sudo rm -rf /home/circlemoon/sysroots/rk3566/usr/lib/qt5
  sudo rm -rf /home/circlemoon/sysroots/rk3566/usr/lib/aarch64-linux-gnu/qt5
  sudo rm -f /home/circlemoon/sysroots/rk3566/usr/bin/aarch64-linux-gnu-qmake

  sudo tar -xpf /mnt/d/qt5-rk3566-dev.tar \
    -C /home/circlemoon/sysroots/rk3566
```

2. éªŒè¯é…ç½®æ–‡ä»¶å·²ç»åˆ°ä½ï¼š

```bash


  find /home/circlemoon/sysroots/rk3566 -name Qt5Config.cmake
  ls -l /home/circlemoon/sysroots/rk3566/usr/lib/aarch64-linux-gnu/qt5/bin/{qmake,moc,rcc}
  ls -l /home/circlemoon/sysroots/rk3566/usr/bin/aarch64-linux-gnu-qmake

```

  çœ‹åˆ°è¯¸å¦‚ `/home/circlemoon/sysroots/rk3566/usr/lib/aarch64-linux-gnu/cmake/Qt5/Qt5Config.cmake` å°±è¯´æ˜æˆåŠŸã€‚
3. å†æ¬¡æ‰§è¡Œæ„å»ºï¼ˆç¡®ä¿ `CMAKE_PREFIX_PATH` æŒ‡å‘åŒ…å« Qt é…ç½®çš„ç›®å½•ï¼‰ï¼š

```bash
   source env/setup-rk3566.sh
   cmake -S . -B build-rk3566 -G Ninja \
         -DCMAKE_TOOLCHAIN_FILE=cmake/toolchains/rk3566.cmake \
         -DCMAKE_PREFIX_PATH=$RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/cmake \
         -DCMAKE_BUILD_TYPE=Release
   cmake --build build-rk3566 --parallel
```

å¤‡é€‰æ–¹æ¡ˆï¼ˆå…æ‰‹åŠ¨æ‹·è´ï¼‰

å¦‚æœä½ æ„¿æ„åœ¨ WSL ä¸Šå¯ç”¨ `arm64` åŒ…ä»“åº“ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å®‰è£… `qtbase5-dev:arm64`ã€`qt5-qmake:arm64` ç­‰å¼€å‘åŒ…ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨æŠŠè¿™äº›æ–‡ä»¶æ”¾è¿› aarch64-linux-gnu ä¸‹ã€‚ä½†éœ€è¦é…ç½®å¤šæ¶æ„æºï¼Œå¯¹ç¯å¢ƒè¦æ±‚ç¨é«˜ã€‚

---

æŒ‰ä¸Šé¢ â€œç²¾é€‰æ‹·è´â€ çš„æ–¹å¼ï¼Œä½ åªéœ€åŒæ­¥ Qt çš„å¼€å‘å­é›†å³å¯ï¼Œè®© `find_package(Qt5 ...)` èƒ½å¤Ÿæ‰¾åˆ° `Qt5Config.cmake`ã€å¯¹åº”åº“ã€å¤´æ–‡ä»¶å’Œ pkg-config é…ç½®ï¼Œåç»­äº¤å‰ç¼–è¯‘å°±ä¸ä¼šå†å¡åœ¨ç¼ºæ–‡ä»¶çš„é—®é¢˜ä¸Šã€‚

#### 3.6 ç»„ä»¶é€»è¾‘ä¸åŸç†

- **CMakeLists.txt**ï¼šé¡¹ç›®çš„ä¸»æ„å»ºè„šæœ¬ï¼Œå®šä¹‰æºç ã€ä¾èµ–å’Œç›®æ ‡ã€‚`find_package(Qt5 ...)` ä¸ `target_link_libraries` å†³å®šæœ€ç»ˆç”Ÿæˆç‰©éœ€è¦å“ªäº›å¤´æ–‡ä»¶å’ŒåŠ¨æ€åº“ã€‚æ— è®ºæ˜¯æœ¬æœºè¿˜æ˜¯äº¤å‰ç¼–è¯‘ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸éœ€è¦æ”¹åŠ¨ï¼Œé€šè¿‡å¤–éƒ¨æä¾›çš„ç¼–è¯‘å™¨/æœç´¢è·¯å¾„å³å¯ç¼–è¯‘åˆ°ä¸åŒå¹³å°ã€‚
- **env/setup-rk3566.sh**ï¼šä¸€é”®å¯¼å‡ºäº¤å‰ç¼–è¯‘æ‰€éœ€çš„ç¯å¢ƒå˜é‡ã€‚å®ƒæŠŠç³»ç»Ÿçš„äº¤å‰ç¼–è¯‘å™¨å‰ç¼€ï¼ˆ`aarch64-linux-gnu-`ï¼‰åŠ å…¥ `PATH`ï¼ŒæŒ‡æ˜ `SYSROOT` ä¸ `PKG_CONFIG_LIBDIR`ï¼Œç¡®ä¿åç»­å‘½ä»¤è¡Œå·¥å…·ï¼ˆCMakeã€pkg-configã€ç¼–è¯‘å™¨ï¼‰éƒ½èƒ½è§£æåˆ°ç›®æ ‡å¹³å°çš„å¤´æ–‡ä»¶å’Œåº“ã€‚
- **cmake/toolchains/rk3566.cmake**ï¼šå‘Šè¯‰ CMake â€œæˆ‘ä¸æ˜¯åœ¨æœ¬æœºç¼–è¯‘â€ï¼ŒæŒ‡å®š `CMAKE_SYSTEM_NAME`ã€äº¤å‰ç¼–è¯‘å™¨è·¯å¾„ã€`CMAKE_SYSROOT` ç­‰ä¿¡æ¯ã€‚è¿™æ · CMake ç”Ÿæˆçš„ç¼–è¯‘å‘½ä»¤å°±ä¼šè°ƒç”¨ `aarch64-linux-gnu-g++`ï¼Œå¹¶æŠŠ sysroot é‡Œçš„ç›®å½•ä½œä¸ºé»˜è®¤çš„ include / lib æœç´¢è·¯å¾„ã€‚
- **æ„å»ºæµç¨‹ä¸²è”**ï¼šå…ˆ `source env/setup-rk3566.sh`ï¼Œå†è¿è¡Œ `cmake -DCMAKE_TOOLCHAIN_FILE=...`ã€‚ç¯å¢ƒè„šæœ¬æä¾›å˜é‡ï¼Œå·¥å…·é“¾æ–‡ä»¶è¯»å–è¿™äº›å˜é‡é…ç½® CMakeï¼Œæœ€å `CMakeLists.txt` æŒ‰æ—¢å®šé€»è¾‘ç”Ÿæˆç›®æ ‡æ–‡ä»¶ã€‚ä¸‰è€…åˆ†å·¥æ˜ç¡®ä½†ç¯ç¯ç›¸æ‰£ã€‚
- **Sysroot çš„è§’è‰²**ï¼šsysroot æ˜¯ç›®æ ‡è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿçš„â€œå¿«ç…§â€ï¼ŒåŒ…å«å¤´æ–‡ä»¶ã€åŠ¨æ€åº“ã€é…ç½®ç­‰ã€‚äº¤å‰ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨åœ¨æœ¬æœºè¿è¡Œå´è¦é“¾æ¥/åŒ…å«ç›®æ ‡å¹³å°çš„èµ„æºï¼Œå°±å¿…é¡»ä» sysroot ä¸­è·å–ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä½•éœ€è¦ä»æ¿å­ç«¯æ‹·è´â€”â€”åªæœ‰æ¿å­å®é™…å®‰è£…çš„åº“ç‰ˆæœ¬æ‰èƒ½ä¿è¯æœ€ç»ˆäºŒè¿›åˆ¶åœ¨æ¿ä¸Šæ­£å¸¸è¿è¡Œï¼›ç¼ºå°‘ Qt çš„ CMake é…ç½®æˆ–åº“æ–‡ä»¶æ—¶ï¼Œ`find_package(Qt5)`ã€é“¾æ¥é˜¶æ®µå°±ä¼šå¤±è´¥ã€‚

#### 3.7 é¡¹ç›®äº¤å‰ç¼–è¯‘

```bash
source env/setup-rk3566.sh
cmake -S /home/circlemoon/kylin/cpp-chatroom \
      -B /home/circlemoon/kylin/cpp-chatroom/build-rk3566 \
      -G "Ninja" \
      -DCMAKE_TOOLCHAIN_FILE=cmake/toolchains/rk3566.cmake \
      -DCMAKE_PREFIX_PATH=$RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/cmake \
      -DCMAKE_BUILD_TYPE=Release

cmake --build /home/circlemoon/kylin/cpp-chatroom/build-rk3566 --parallel
```

å®Œæˆåç”¨ `file build-rk3566/bin/FeiQChatroom` ç¡®è®¤ç›®æ ‡æ¶æ„ï¼Œå¹¶å¯ `tar -cpf build-rk3566.tar -C build-rk3566 bin lib` ä»¥ä¾¿ä¼ è¾“ã€‚

#### 3.8 è¿è¡Œä¸éªŒè¯

- å°†äºŒè¿›åˆ¶ä¸ä¾èµ–åº“æ‹·è´å›æ¿ç«¯ï¼›è‹¥ä½¿ç”¨è‡ªå»º Qtï¼Œéœ€è¦ä¸€å¹¶éƒ¨ç½² `/opt/qt-5.12.8-rk3566`ã€‚
- æ¿ç«¯è¿è¡Œï¼š
  ```bash
  export LD_LIBRARY_PATH=/opt/qt-5.12.8-rk3566/lib:$LD_LIBRARY_PATH
  export QT_QPA_PLATFORM=linuxfb   # æˆ– wayland/xcbï¼Œè§†ç¯å¢ƒè€Œå®š
  /opt/feiqlab/FeiQChatroom
  ```
- `ldd /opt/feiqlab/FeiQChatroom` å¯å¤æ ¸ä¾èµ–è§£ææƒ…å†µã€‚

#### 3.9 å¸¸è§é—®é¢˜

- **å¤´æ–‡ä»¶ç¼ºå¤± / pkg-config æŠ¥é”™**ï¼šæ£€æŸ¥ sysroot ä¸­çš„ `usr/include` ä¸ `pkgconfig` ç›®å½•æ˜¯å¦å®Œæ•´ï¼Œå¿…è¦æ—¶é‡æ–°åŒæ­¥ã€‚
- **GLIBC ç‰ˆæœ¬ä¸åŒ¹é…**ï¼šä½¿ç”¨ç³»ç»Ÿ `gcc-aarch64-linux-gnu`ï¼›è‹¥å¿…é¡»ä½¿ç”¨ SDK å·¥å…·é“¾ï¼Œåˆ™éœ€åŒæ­¥å…¶é…å¥— libcã€‚ï¼ˆå­˜åœ¨å‡çº§æ¿ç«¯ç³»ç»Ÿé£é™©ï¼Œè¯·è°¨æ…ã€‚ï¼‰
- **Qt CMake æ–‡ä»¶ç¼ºå¤±**ï¼šè¡¥é½ `usr/lib/aarch64-linux-gnu/cmake/Qt5*`ï¼Œæˆ–æ”¹ç”¨è‡ªè¡Œäº¤å‰ç¼–è¯‘çš„ Qtã€‚
- **crt1.o / crti.o æœªæ‰¾åˆ°**ï¼šæŒ‰ 3.3 ä¸­æ­¥éª¤å¤åˆ¶ startfilesï¼Œç¡®ä¿ `aarch64-none-linux-gnu` è½¯é“¾æ¥å­˜åœ¨ã€‚
- **è¿è¡Œæ—¶åº“ç¼ºå¤±**ï¼šåœ¨æ¿ç«¯æ‰§è¡Œ `ldd` æŸ¥æ¼è¡¥ç¼ºï¼ŒæŠŠç¼ºå°‘çš„ `.so` æ–‡ä»¶æ”¾å…¥åº”ç”¨å¯è®¿é—®çš„ç›®å½•ï¼ˆå¸¸ç”¨ `/opt/feiqlab/lib`ï¼‰ã€‚
- **Qt æ¨¡å—éœ€æ±‚**ï¼šå½“å‰é¡¹ç›®åªé“¾æ¥ `Core`/`Gui`/`Widgets`/`Network`ã€‚å¦‚åç»­ä½¿ç”¨ `Qt Charts`ã€`Svg`ã€`Multimedia` ç­‰æ¨¡å—ï¼Œéœ€è¦åŒæ­¥å¯¹åº”è¿è¡Œåº“å’Œ `*-dev` åŒ…ã€‚

### 4. éªŒè¯æµç¨‹å»ºè®®

- **ç‰ˆæœ¬ä¸€è‡´æ€§**ï¼šä¿æŒä¸»æœºã€Windowsã€RK3566 ä¸Š Qt ä¸»ç‰ˆæœ¬ä¸€è‡´ï¼ˆ5.12.xï¼‰ï¼Œå‡å°‘ ABI å·®å¼‚ã€‚
- **æ„å»ºç¼“å­˜**ï¼šä¸åŒç›®æ ‡ä½¿ç”¨å„è‡ªçš„æ„å»ºç¼“å­˜ç›®å½•ï¼Œé¿å…äº¤å‰æ±¡æŸ“ã€‚
- **æ—¥å¿—è®°å½•**ï¼šå°†æ¯æ¬¡ configure çš„å‚æ•°å†™å…¥è„šæœ¬æˆ– Markdownï¼Œæ–¹ä¾¿æ’æŸ¥ã€‚
- **éƒ¨ç½²æµ‹è¯•**ï¼š
  - Windowsï¼šåœ¨åŸç”Ÿ Windows ç¯å¢ƒè¿è¡Œ `FeiQChatroom.exe` å¹¶éªŒè¯ `windeployqt` ç»“æœã€‚
  - RK3566ï¼šæ£€æŸ¥ç½‘ç»œé…ç½®ã€æ˜¾ç¤ºåç«¯ï¼ˆFBã€Waylandã€X11ï¼‰æ˜¯å¦åŒ¹é…åº”ç”¨è®¾ç½®ã€‚

é€šè¿‡ä¸Šè¿°å‡†å¤‡ï¼Œå³å¯åœ¨ WSL ä¸­é«˜æ•ˆå®Œæˆé¢å‘ Windows x64 ä¸ RK3566 Kylin Ubuntu çš„äº¤å‰ç¼–è¯‘ã€‚

### 5. è°ƒè¯•è®°å½•ä¸ç»éªŒå›é¡¾

#### 5.1 è°ƒè¯•é‡Œç¨‹ç¢‘æ¦‚è§ˆ

- **å‡†å¤‡æ–‡æ¡£**ï¼šæ¢³ç† `CMakeLists.txt`ã€`env/`ã€`cmake/toolchains/` å„æ–‡ä»¶èŒè´£ï¼Œå¹¶è¡¥å…… sysroot é‡‡é›†æµç¨‹ã€‚
- **å°è¯• SDK rootfs**ï¼šä¼˜å…ˆè§£å‹ SDK è‡ªå¸¦ sysrootï¼Œå›  Qt ç»„ä»¶ç¼ºå¤±ä¸ç‰ˆæœ¬å·®å¼‚è€Œæ”¾å¼ƒã€‚
- **æ¿ç«¯é‡æ–°å¯¼å‡º sysroot**ï¼šåœ¨å®é™…è®¾å¤‡ä¸Šå®‰è£…ç¼ºå¤± dev åŒ…åç¦»çº¿æ‰“åŒ…ï¼Œæ›¿æ¢ WSL å†…æ—§é•œåƒã€‚
- **å¤šè½® CMake é…ç½®**ï¼šè§£å†³ `find_package(Qt5)`ã€`FindThreads`ã€EGL è·¯å¾„ç­‰é˜»å¡ï¼Œç¨³å®šç”Ÿæˆæ„å»ºç³»ç»Ÿã€‚
- **æ„å»ºæœŸä¿®å¤**ï¼šè¡¥é½ `sqlite3` å¤´æ–‡ä»¶ã€æ³¨å…¥ host ç‰ˆ `moc/rcc/uic`ï¼Œæ¸…ç†ç¼“å­˜åå®Œæˆç¼–è¯‘ã€‚
- **éƒ¨ç½²éªŒè¯**ï¼šå¤„ç† U ç›˜æ‹·è´å¯¼è‡´çš„æ‰§è¡Œä½ä¸¢å¤±é—®é¢˜ï¼Œæœ€ç»ˆåœ¨ RK3566 ä¸Šè¿è¡ŒæˆåŠŸã€‚

#### 5.2 å…¸å‹é—®é¢˜æ¡ˆä¾‹

ä¸‹åˆ—æ¡ˆä¾‹æŒ‰å‡ºç°é¡ºåºè®°å½•ç—‡çŠ¶ã€æ ¹å› ä¸è§£å†³æ–¹æ¡ˆï¼Œä¾¿äºå¿«é€Ÿå¯¹ç…§æ’æŸ¥ã€‚

##### Qt åº“å¼•ç”¨ç»å¯¹è·¯å¾„å¯¼è‡´ `libEGL.so` ä¸¢å¤±

- **ç—‡çŠ¶**ï¼š`find_package(Qt5Gui)` æŠ¥é”™ `The imported target "Qt5::Gui" references /usr/lib/aarch64-linux-gnu/mali/libEGL.so but this file does not exist.`
- **æ ¹å› **ï¼š`Qt5GuiConfigExtras.cmake` å°† EGL è·¯å¾„ç¡¬ç¼–ç ä¸ºç»å¯¹è·¯å¾„ï¼Œæœªæ‹¼æ¥ `CMAKE_SYSROOT`ã€‚
- **å¤„ç†**ï¼šåœ¨å®¿ä¸» `/usr/lib/aarch64-linux-gnu/mali` ç›®å½•åˆ›å»ºæŒ‡å‘ sysroot å†…éƒ¨çš„ç¬¦å·é“¾æ¥ï¼›å¤‡é€‰æ–¹æ¡ˆæ˜¯ä¿®æ”¹è¯¥ CMake é…ç½®è¿½åŠ  `CMAKE_SYSROOT`ã€‚
- **è¦ç‚¹**ï¼šåŒæ­¥ sysroot åç«‹å³æŠ½æ£€ `usr/lib/aarch64-linux-gnu/mali/libEGL.so` æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ç¡®è®¤å®¿ä¸»ä¾§é“¾æ¥ç­–ç•¥ã€‚

##### CMake æ‰¾ä¸åˆ° Threads

- **ç—‡çŠ¶**ï¼š`Could NOT find Threads (missing: Threads_FOUND)`ï¼Œ`-pthread` æ£€æµ‹å§‹ç»ˆå¤±è´¥ã€‚
- **æ ¹å› **ï¼šæ—©æœŸæ„å»ºç¼“å­˜è®°å½•äº†é”™è¯¯çš„å·¥å…·é“¾/æ ‡å¿—ï¼Œåç»­å³ä½¿è¡¥é½åº“ä¹Ÿæ— æ³•é€šè¿‡æ£€æµ‹ã€‚
- **å¤„ç†**ï¼šåˆ é™¤ `build-rk3566` é…ç½®ç¼“å­˜åé‡æ–°è¿è¡Œ `cmake`ï¼Œ`FindThreads` ç«‹å³è¯†åˆ« `pthread`ã€‚
- **è¦ç‚¹**ï¼šä¿®æ”¹å·¥å…·é“¾ã€sysroot æˆ–ç¯å¢ƒå˜é‡åï¼Œä¼˜å…ˆæ¸…ç†ç¼“å­˜å†é‡è¯•ã€‚

##### `sqlite3.h` å¤´æ–‡ä»¶ç¼ºå¤±

- **ç—‡çŠ¶**ï¼šç¼–è¯‘ `history.cpp` æ—¶æç¤º `fatal error: sqlite3.h: No such file or directory`ã€‚
- **æ ¹å› **ï¼šæœ€åˆ sysroot åªåŒ…å«è¿è¡Œåº“ `libsqlite3.so*`ï¼Œç¼ºå°‘å¯¹åº” dev åŒ…ã€‚
- **å¤„ç†**ï¼šåœ¨ WSL å¯ç”¨ `arm64` å¤šæ¶æ„æºå®‰è£… `libsqlite3-dev:arm64`ï¼Œå°†å¤´æ–‡ä»¶ã€åº“ä¸ `sqlite3.pc` åŒæ­¥è¿› sysrootã€‚
- **è¦ç‚¹**ï¼šè¿è¡Œåº“ä¸å¼€å‘åŒ…å¿…é¡»æˆå¯¹åŒæ­¥ï¼Œå¿…è¦æ—¶ä¼˜å…ˆä½¿ç”¨å¤šæ¶æ„ä»“åº“è·å–ã€‚

##### Qt Host å·¥å…· (`moc`/`rcc`/`uic`) æ— æ³•æ‰§è¡Œ

- **ç—‡çŠ¶**ï¼š`/home/.../qt5/bin/moc: ELFï¿½ï¿½Q@ï¿½ï¿½`ï¼Œè‡ªåŠ¨ç”Ÿæˆé˜¶æ®µæŠ¥è¯­æ³•ä¸ ELF é”™è¯¯ã€‚
- **æ ¹å› **ï¼šsysroot å†…çš„å·¥å…·ä¸º ARM ELFï¼Œæ— æ³•ç›´æ¥åœ¨ x86_64 å®¿ä¸»æ‰§è¡Œã€‚
- **å¤„ç†**ï¼šåœ¨å®¿ä¸»å®‰è£… `qttools5-dev-tools`ï¼Œå°† sysroot ä¸­çš„åŒåäºŒè¿›åˆ¶é‡å‘½åä¸º `.real`ï¼Œä»¥ shell åŒ…è£…è„šæœ¬è°ƒç”¨å®¿ä¸»ç‰ˆæœ¬ã€‚
- **è¦ç‚¹**ï¼šå‡¡æ˜¯â€œæ„å»ºæ—¶è¿è¡Œâ€çš„å·¥å…·éƒ½éœ€ä½¿ç”¨å®¿ä¸»å¯æ‰§è¡Œç‰ˆæœ¬ï¼Œå¯é€šè¿‡ wrapper ä¿æŒè·¯å¾„é€æ˜ã€‚

##### U ç›˜æ‹·è´åçš„å¯æ‰§è¡Œæƒé™é—®é¢˜

- **ç—‡çŠ¶**ï¼šå°†äº§ç‰©å¤åˆ¶åˆ°æ¿ç«¯åæ‰§è¡ŒæŠ¥ `Permission denied`ã€‚
- **æ ¹å› **ï¼šFAT/exFAT ä¸ä¿ç•™æ‰§è¡Œä½ï¼Œä¸”è¯¯ç”¨ `chmod +X`ï¼ˆå¤§å†™ï¼‰æœªèƒ½æ¢å¤æƒé™ã€‚
- **å¤„ç†**ï¼šå…ˆå¤åˆ¶åˆ°æ¿ç«¯ ext4 åˆ†åŒºï¼Œä½¿ç”¨å°å†™ `chmod +x` æ¢å¤æ‰§è¡Œä½ã€‚
- **è¦ç‚¹**ï¼šè·¨æ–‡ä»¶ç³»ç»Ÿä¼ è¾“åä¼˜å…ˆåœ¨ ext4 æ£€æŸ¥æƒé™ï¼Œè°¨æ…åŒºåˆ† `+x` ä¸ `+X`ã€‚

##### SDK è‡ªå¸¦ sysroot çš„ä¿®å¤å¤±è´¥

- **ç—‡çŠ¶**ï¼šä½¿ç”¨ SDK rootfs æ—¶æŒç»­ç¼º `Qt5Config.cmake`ã€`moc/rcc`ã€Mali EGL ç­‰æ–‡ä»¶ã€‚
- **æ ¹å› **ï¼šSDK é•œåƒç¼ºå¤±åç»­åœ¨æ¿ç«¯é¢å¤–å®‰è£…çš„ dev åŒ…ä¸é©±åŠ¨ï¼Œä¸”å·¥å…·é“¾ç‰ˆæœ¬ä¸æ¿ç«¯ä¸ä¸€è‡´ã€‚
- **å¤„ç†**ï¼šåœæ­¢åœ¨ SDK é•œåƒä¸Šâ€œè¡¥ä¸å¼â€åŒæ­¥ï¼Œè½¬ä¸ºä»¥æ¿ç«¯å®æ—¶ rootfs ä¸ºåŸºå‡†é‡æ–°å¯¼å‡ºã€‚
- **è¦ç‚¹**ï¼šè‹¥ç›®æ ‡è®¾å¤‡æ›¾åšè¿‡äºŒæ¬¡å®‰è£…æˆ–å‡çº§ï¼Œåº”ä»¥è®¾å¤‡ç°åœºç¯å¢ƒä½œä¸ºå”¯ä¸€å¯ä¿¡ sysroot æ¥æºã€‚

#### 5.3 Sysroot æ‰“åŒ…å¤ç›˜ä¸è‡ªæ£€æ¸…å•

- **æ‰“åŒ…å‘½ä»¤æ¨è**ï¼š

  ```bash
  sudo tar -cpf /tmp/rk3566-sysroot-$(date +%Y%m%d).tar \
      --numeric-owner --xattrs --acls \
      -C / \
      usr/lib usr/include usr/bin usr/share \
      lib etc/ld.so.conf etc/ld.so.conf.d etc/ld.so.cache
  ```
- **å¿…å¤‡ç›®å½•**ï¼š`usr/lib/aarch64-linux-gnu/`ã€`usr/include/aarch64-linux-gnu/`ã€`usr/lib/aarch64-linux-gnu/cmake/`ã€`usr/lib/aarch64-linux-gnu/pkgconfig/`ã€‚
- **å¿«é€Ÿè‡ªæ£€**ï¼š

  - `find $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/cmake -name Qt5Config.cmake`
  - `ls $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/mali/libEGL.so`
  - `ls $RK3566_SYSROOT/usr/include/aarch64-linux-gnu/qt5/QtCore`ï¼ˆæˆ– `pkg-config --variable=includedir Qt5Core`ï¼‰
- **å¢é‡æ›´æ–°æé†’**ï¼šè‹¥æ¿ç«¯æ–°å¢åŒ…æˆ–é©±åŠ¨ï¼Œéœ€é‡æ–°æ‰“åŒ…å¹¶è¦†ç›– WSL sysrootï¼Œé¿å…æ··ç”¨æ—§ç‰ˆç»„ä»¶ã€‚

#### 5.4 æ ¸å¿ƒé€»è¾‘é“¾æ¡å›é¡¾

- **CMakeLists.txt**ï¼šè´Ÿè´£å£°æ˜æºæ–‡ä»¶ã€ä¾èµ–ä¸ç›®æ ‡ï¼Œå¯¹äº¤å‰ç¼–è¯‘é€æ˜ï¼Œæ ¸å¿ƒæ˜¯ `find_package` ä¸ `target_link_libraries` çš„è¾“å…¥æ˜¯å¦å¯ç”¨ã€‚
- **ç¯å¢ƒè„šæœ¬ (`env/setup-rk3566.sh`)**ï¼šç»Ÿä¸€å¯¼å‡ºäº¤å‰ç¼–è¯‘å™¨å‰ç¼€ã€`SYSROOT` ä¸ pkg-config è·¯å¾„ï¼Œæ˜¯ä¸€åˆ‡å‘½ä»¤çš„å…¥å£ã€‚
- **å·¥å…·é“¾æ–‡ä»¶ (`cmake/toolchains/rk3566.cmake`)**ï¼šå‘Šè¯‰ CMake ä½¿ç”¨å“ªå¥—ç¼–è¯‘å™¨ä¸ sysrootï¼Œå¹¶é™åˆ¶æœç´¢è·¯å¾„è½åœ¨ç›®æ ‡æ ¹æ–‡ä»¶ç³»ç»Ÿå†…ã€‚
- **Sysroot**ï¼šæä¾›ç›®æ ‡æ¿çš„å¤´æ–‡ä»¶ã€åº“ã€é…ç½®ï¼Œæ˜¯ç¡®ä¿ ABI ä¸ä¾èµ–åŒ¹é…çš„åŸºçŸ³ã€‚
- **æ„å»ºä¸²è”**ï¼š`source env/setup-rk3566.sh` â†’ `cmake -S . -B build-rk3566 -DCMAKE_TOOLCHAIN_FILE=...` â†’ `cmake --build ...` â†’ éƒ¨ç½²éªŒè¯ã€‚

#### 5.5 ç»éªŒæ€»ç»“

- **ä¿æŒ sysroot æ–°é²œåº¦**ï¼šè®¾å¤‡å‡çº§æˆ–å®‰è£…æ–°åŒ…åé‡æ–°å¯¼å‡ºï¼Œé¿å…æ½œåœ¨ ABI æˆ–ä¾èµ–é”™ä½ã€‚
- **ä¼˜å…ˆæ¸…ç†ç¼“å­˜**ï¼šä¿®æ”¹å·¥å…·é“¾å‚æ•°æˆ–è¡¥é½ä¾èµ–åï¼Œåˆ é™¤æ—§çš„ `build-rk3566` ç›®å½•å†è¿è¡Œ CMakeã€‚
- **å–„ç”¨å¤šæ¶æ„ä»“åº“**ï¼šåœ¨ WSL å¯ç”¨ `[arch=arm64]` æºï¼Œå¯ä»¥å¿«é€Ÿè·å–éœ€è¦çš„ ARM ç‰ˆå¼€å‘åŒ…ã€‚
- **åŒ…è£…æ„å»ºæœŸå·¥å…·**ï¼šå‡¡æ˜¯æ„å»ºæœŸæ‰§è¡Œçš„äºŒè¿›åˆ¶ï¼ˆ`moc`/`rcc`/`uic` ç­‰ï¼‰éƒ½åº”æŒ‡å‘å®¿ä¸»ç‰ˆæœ¬ã€‚
- **å…³æ³¨æ–‡ä»¶ç³»ç»Ÿå·®å¼‚**ï¼šè·¨ FAT/NTFS/FUSE ä¸ ext4 ä¼ è¾“æ—¶ç•™æ„æƒé™ä½ä¸å¤§å°å†™é—®é¢˜ã€‚
- **è®°å½•å‚æ•°ä¸æ—¥å¿—**ï¼šä¿ç•™æ¯æ¬¡é…ç½®å‘½ä»¤ä¸å…³é”®æ—¥å¿—ï¼Œåç»­å¤ç›˜èƒ½è¿…é€Ÿå®šä½å·®å¼‚ã€‚

## æ€»ä½“æµç¨‹å›é¡¾

æœ¬è®°å½•æ•´ç†äº†è‡ªâ€œå¸Œæœ›è¯¦ç»†ç†è§£äº¤å‰ç¼–è¯‘æµç¨‹åŠç›¸å…³æ–‡ä»¶é€»è¾‘â€èµ·çš„è°ƒè¯•ä¸é—®ç­”è¿‡ç¨‹ï¼Œæ¶µç›–ä» sysroot è·å–ã€CMake/ç¯å¢ƒè„šæœ¬è§£é‡Šï¼Œåˆ°æ„å»ºæœŸé—´é‡åˆ°çš„å…·ä½“é”™è¯¯ä¸ä¿®å¤æ–¹å¼ã€‚ç›®æ ‡æ˜¯ä½œä¸º Obsidian ä¸­çš„å½’æ¡£ç¬”è®°ï¼Œä¾¿äºåç»­å¤ç›˜ä¸çŸ¥è¯†ç§¯ç´¯ã€‚

1. **å‡†å¤‡æ–‡æ¡£è¯´æ˜**ï¼šåœ¨ `RK3566äº¤å‰ç¼–è¯‘.md` ä¸­è¡¥å…… CMakeListsã€`env/` ä¸ `cmake/toolchains/` æ–‡ä»¶çš„è§’è‰²ã€sysroot ç”¨é€”åŠè·å–æ–¹å¼ã€‚
2. **å°è¯• SDK sysroot (å¤±è´¥)**ï¼š**ï¼ˆæœ¬æ¬¡è¡¥å……ï¼‰** å…ˆè§£å‹ SDK é™„å¸¦çš„ rootfs é•œåƒ (`Ubuntu20.04.3LTS_Firefly_..._rootfs.img`) ä½œä¸º sysrootã€‚
3. **ä¿®å¤ SDK sysroot (å¤±è´¥)**ï¼š**ï¼ˆæœ¬æ¬¡è¡¥å……ï¼‰** å°è¯• `cmake` é…ç½®ï¼Œé­é‡ Qt ç»„ä»¶ã€EGL åº“ã€`moc`/`rcc` å·¥å…·é“¾å…¨é¢ç¼ºå¤±ã€‚å°è¯•ä» SDK å…¶ä»–ç›®å½•é›¶æ˜Ÿè¡¥å……ï¼Œä½†å› ç‰ˆæœ¬é”™é…å’Œä¾èµ–é»‘æ´æœ€ç»ˆæ”¾å¼ƒã€‚
4. **é‡æ–°é‡‡é›† sysroot**ï¼šåœ¨æ¿ç«¯ï¼ˆç›®æ ‡æœºï¼‰æ‰§è¡Œç¦»çº¿æ‰“åŒ… `tar` å‘½ä»¤ï¼Œå°†åŒ…å« `qt5-dev` ç­‰å®Œæ•´å¼€å‘åŒ…çš„ `/usr`, `/lib` ç­‰ç›®å½•æ‰“åŒ…ã€‚
5. **éƒ¨ç½² sysroot**ï¼šå°† `sysroot.tar` æ›¿æ¢ WSL å†…çš„æ—§ sysrootï¼Œç¡®ä¿ Qt ç»„ä»¶å®Œæ•´ã€‚
6. **CMake é…ç½®é˜¶æ®µ**ï¼šå¤šæ¬¡ `cmake -S . -B build-rk3566 ...`ï¼Œè§£å†³ Qt ç»å¯¹è·¯å¾„ã€çº¿ç¨‹åº“æ£€æµ‹ç­‰é—®é¢˜ã€‚
7. **æ„å»ºé˜¶æ®µ**ï¼šå¤„ç†ä¾èµ–ç¼ºå¤±ï¼ˆ`sqlite3.h`ï¼‰ã€Qt host å·¥å…·ä¸å¯æ‰§è¡Œï¼ˆ`moc` ELF é”™è¯¯ï¼‰ã€è‡ªåŠ¨ç”Ÿæˆä»£ç å¤±è´¥ç­‰é˜»å¡ã€‚
8. **éƒ¨ç½²ä¸è¿è¡Œ**ï¼šå°†ç¼–è¯‘äº§ç‰©é€šè¿‡ U ç›˜æ‹·è´è‡³ RK æ¿ï¼Œè§£å†³å›  FAT åˆ†åŒºå¯¼è‡´ `Permission denied` çš„æƒé™é—®é¢˜åæˆåŠŸè¿è¡Œã€‚

## å…³é”®é—®é¢˜ä¸è§£å†³æ‘˜è¦

### Qt åº“å¼•ç”¨ç»å¯¹è·¯å¾„å¯¼è‡´ `libEGL.so` ä¸¢å¤±

* **è¡¨ç°**ï¼šCMake æŠ¥é”™ `The imported target "Qt5::Gui" references /usr/lib/aarch64-linux-gnu/mali/libEGL.so but this file does not exist.`
* **æ ¹å› **ï¼š`Qt5GuiConfigExtras.cmake` ä¸­ç¡¬ç¼–ç ç»å¯¹è·¯å¾„ï¼Œæœªæ‹¼æ¥ `CMAKE_SYSROOT`ã€‚
* **å¤„ç½®**ï¼šé€šè¿‡ wrapper è„šæœ¬åœ¨å®¿ä¸»åˆ›å»ºè½¯é“¾æ¥æˆ–ä¿®æ”¹ `Qt5GuiConfigExtras.cmake`ï¼Œæœ€ç»ˆé€‰æ‹©åœ¨å®¿ä¸» `/usr/lib/aarch64-linux-gnu/mali` åˆ›å»ºæŒ‡å‘ sysroot çš„ç¬¦å·é“¾æ¥ã€‚

### CMake æ‰¾ä¸åˆ° Threads

* **è¡¨ç°**ï¼š`Could NOT find Threads (missing: Threads_FOUND)`ã€‚
* **æ ¹å› **ï¼šåˆæœŸ CMake ç¼“å­˜ä¸­ç”±äºæ—§é…ç½®é—ç•™å¯¼è‡´çº¿ç¨‹æ£€æµ‹å¼‚å¸¸ã€‚
* **å¤„ç½®**ï¼šæ¸…ç†æ„å»ºç¼“å­˜ï¼ˆåˆ é™¤ `build-rk3566` ç›®å½•ï¼‰åé‡æ–°è¿è¡Œé…ç½®ï¼Œå³å¯å‘ç° `pthread`ã€‚

### `sqlite3.h` å¤´æ–‡ä»¶ç¼ºå¤±

* **è¡¨ç°**ï¼šç¼–è¯‘ `history.cpp` æ—¶æç¤º `fatal error: sqlite3.h: No such file or directory`ã€‚
* **æ ¹å› **ï¼šsysroot ä»…åŒ…å«è¿è¡Œåº“ `libsqlite3.so*`ï¼Œç¼ºå°‘å¼€å‘å¤´æ–‡ä»¶ã€‚
* **å¤„ç½®**ï¼šåœ¨ WSL ä¾§å¯ç”¨ `arm64` å¤šæ¶æ„æºï¼ˆ`ubuntu-ports`ï¼‰ï¼Œå®‰è£… `libsqlite3-dev:arm64`ï¼Œå¹¶å°†å¤´æ–‡ä»¶ã€åº“ã€`sqlite3.pc` åŒæ­¥åˆ° sysrootã€‚

### Qt Host å·¥å…· (`moc`/`rcc`/`uic`) æ— æ³•æ‰§è¡Œ

* **è¡¨ç°**ï¼š`/home/.../qt5/bin/moc: ELFQ@`ï¼ŒCMake è‡ªåŠ¨ç”Ÿæˆé˜¶æ®µå¤±è´¥ã€‚
* **æ ¹å› **ï¼šsysroot å†…çš„ `moc` ç­‰ä¸º ARM ELFï¼Œæ„å»ºæœºï¼ˆWSLï¼‰ä¸º x86 æ— æ³•ç›´æ¥è¿è¡Œã€‚
* **å¤„ç½®**ï¼šå®‰è£…å®¿ä¸» `qttools5-dev-tools`ï¼Œå†™åŒ…è£…è„šæœ¬ï¼ˆwrapper scriptï¼‰æ›¿æ¢ sysroot å†…å¯¹åº”å·¥å…·ï¼Œå°†è°ƒç”¨è½¬å‘åˆ°å®¿ä¸» x86 ç‰ˆçš„ `/usr/lib/qt5/bin/*`ã€‚

### U ç›˜æ‹·è´åçš„å¯æ‰§è¡Œæƒé™é—®é¢˜

* **è¡¨ç°**ï¼šåœ¨æ¿ç«¯ `./FeiQChatroom` æŠ¥ `Permission denied`ã€‚
* **æ ¹å› **ï¼šU ç›˜çš„ FAT/exFAT åˆ†åŒºä¸ä¿å­˜ POSIX æ‰§è¡Œæƒé™ã€‚
* **å¤„ç½®**ï¼šå°†æ–‡ä»¶**ä» U ç›˜å¤åˆ¶åˆ°æ¿ç«¯ ext4 ç›®å½•**ï¼ˆå¦‚ `~/Desktop`ï¼‰åï¼Œä½¿ç”¨**å°å†™ `x`** æ‰§è¡Œ `chmod +x`ï¼Œç¡®è®¤æƒé™æ¢å¤å³å¯è¿è¡Œã€‚

### SDK è‡ªå¸¦ sysroot ä¿®å¤å¤±è´¥

* **è¡¨ç°**ï¼š**ï¼ˆæœ¬æ¬¡è¡¥å……ï¼‰** ä½¿ç”¨ SDK `rootfs.img` è§£å‹åä½œä¸º sysrootï¼Œ`cmake` æŠ¥é”™ï¼Œæç¤º `Qt5Config.cmake` ç¼ºå¤±ã€‚
* **æ ¹å› **ï¼š**ï¼ˆæœ¬æ¬¡è¡¥å……ï¼‰** SDK é•œåƒæ˜¯**è¿è¡Œæ—¶**é•œåƒï¼Œä¸å«ä»»ä½• `-dev` å¼€å‘åŒ…ï¼ˆå¤´æ–‡ä»¶ã€CMake é…ç½®ã€`.pc` æ–‡ä»¶ç­‰ï¼‰ã€‚
* **å¤„ç½®**ï¼š**ï¼ˆæœ¬æ¬¡è¡¥å……ï¼‰** æ”¾å¼ƒâ€œä¿®è¡¥â€SDK sysroot çš„æ–¹æ¡ˆï¼Œè½¬ä¸ºä»å·²å®‰è£…å¥½å¼€å‘åŒ…çš„ç›®æ ‡æ¿ä¸Šå®Œæ•´å¯¼å‡º sysrootã€‚

---

## é—®é¢˜è¯¦è§£ä¸è¿‡ç¨‹è®°å½•

#### 0\. cmake æ–‡ä»¶é…ç½®é—®é¢˜

- `libEGL.so` å’Œ `libGLES*` å·²ç»åœ¨æ–° sysroot é‡Œ (`$RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/mali/`)ï¼Œé—®é¢˜æ¥è‡ª `Qt5GuiConfigExtras.cmake` æŠŠè¿™äº›åº“å†™æˆç»å¯¹è·¯å¾„ `/usr/...`ï¼Œ`find_package(Qt5)` åœ¨å®¿ä¸»æœºä¸Šæ£€æŸ¥è¿™äº›è·¯å¾„æ—¶æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œäºæ˜¯æå‰æŠ¥é”™ã€‚
- å¤„ç†æ–¹å¼ 1ï¼ˆæ¨èï¼‰ï¼šè®©é…ç½®æ–‡ä»¶æ„ŸçŸ¥ `CMAKE_SYSROOT`ã€‚å¯ç›´æ¥åœ¨ WSL ä¸Šç”¨ sudo ç¼–è¾‘ `Qt5GuiConfigExtras.cmake`ï¼ŒæŠŠæœ«å°¾ä¸¤è¡Œæ”¹æˆä¸‹åˆ—å½¢å¼ï¼ˆç¤ºä¾‹å¯ç”¨ `sudo nano` æˆ– `sudoedit` æ‰“å¼€æ–‡ä»¶ï¼‰ï¼š
  ```cmake
  set(_qt5gui_EGL_LIBS "/usr/lib/aarch64-linux-gnu/mali/libEGL.so;/lib/aarch64-linux-gnu/libmali.so")
  if(CMAKE_SYSROOT)
      list(INSERT _qt5gui_EGL_LIBS 0 "${CMAKE_SYSROOT}/usr/lib/aarch64-linux-gnu/mali/libEGL.so")
      list(INSERT _qt5gui_EGL_LIBS 1 "${CMAKE_SYSROOT}/lib/aarch64-linux-gnu/libmali.so")
  endif()
  _qt5gui_find_extra_libs(EGL "${_qt5gui_EGL_LIBS}" "" "/usr/include/mali")

  set(_qt5gui_GLES_LIBS "/usr/lib/aarch64-linux-gnu/mali/libGLESv2.so;/lib/aarch64-linux-gnu/libmali.so")
  if(CMAKE_SYSROOT)
      list(INSERT _qt5gui_GLES_LIBS 0 "${CMAKE_SYSROOT}/usr/lib/aarch64-linux-gnu/mali/libGLESv2.so")
      list(INSERT _qt5gui_GLES_LIBS 1 "${CMAKE_SYSROOT}/lib/aarch64-linux-gnu/libmali.so")
  endif()
  _qt5gui_find_extra_libs(OPENGL "${_qt5gui_GLES_LIBS}" "" "/usr/include/mali")
  ```
  ä¿å­˜åé‡æ–° `cmake -B build-rk3566` å³å¯ï¼›`_qt5_Gui_check_file_exists` ä¼šå…ˆçœ‹åˆ°å¸¦ sysroot å‰ç¼€çš„è·¯å¾„ï¼Œæ ¡éªŒå°±èƒ½é€šè¿‡ã€‚
- å¤„ç†æ–¹å¼ 2ï¼ˆä¸´æ—¶æ–¹æ¡ˆï¼‰ï¼šåœ¨ WSL å®¿ä¸»æœºåˆ›å»ºæŒ‡å‘ sysroot çš„è½¯é“¾æ¥ï¼Œè®© `/usr/lib/aarch64-linux-gnu/mali/` çœŸå®å­˜åœ¨ã€‚ä¾‹å¦‚ï¼š
  ```bash
  sudo mkdir -p /usr/lib/aarch64-linux-gnu/mali
  for lib in libEGL.so libEGL.so.1 libGLESv2.so libGLESv2.so.2 libGLESv1_CM.so libGLESv1_CM.so.1 libMali.so libMali.so.1; do
      sudo ln -sf $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/mali/$lib /usr/lib/aarch64-linux-gnu/mali/$lib
  done
  ```
  è¿™ç§æ–¹å¼ä¼šæ”¹åŠ¨å®¿ä¸» usrï¼Œåç»­ apt å‡çº§å¯èƒ½è¦†ç›–ï¼Œè®°å¾—åé¢æ¸…ç†ã€‚
- ä»»é€‰å…¶ä¸€åï¼Œå†æ¬¡æ‰§è¡Œ `cmake -S . -B build-rk3566 ...`ã€‚å¦‚æœåç»­è¿˜æç¤ºå…¶å®ƒç»å¯¹è·¯å¾„ç¼ºå¤±ï¼ŒæŒ‰åŒæ ·æ–¹å¼åŠ å…¥ sysroot å‰ç¼€æˆ–è¡¥å……è½¯é“¾æ¥å³å¯ã€‚

### 1\. Qt åº“ç»å¯¹è·¯å¾„ä¸ `libEGL.so` ç¼ºå¤±

* **ç—‡çŠ¶**ï¼š`find_package(Qt5Gui)` é˜¶æ®µ CMake æŠ›å‡º `libEGL.so` æ‰¾ä¸åˆ°ã€‚
* **è°ƒæŸ¥**ï¼šsysroot å†…å­˜åœ¨ç›®æ ‡åº“ (`$RK3566_SYSROOT/usr/lib/.../mali/libEGL.so`)ï¼Œä½† CMake æ£€æŸ¥çš„æ˜¯å®¿ä¸»æœºçš„ç»å¯¹è·¯å¾„ `/usr/lib/...`ã€‚
* **åˆ†æ**ï¼šè¿™æ˜¯å› ä¸º `Qt5GuiConfigExtras.cmake` æ–‡ä»¶ä¸­ç¡¬ç¼–ç äº†ç»å¯¹è·¯å¾„ï¼Œè¯¥æ–‡ä»¶åœ¨ç”Ÿæˆæ—¶æœªè€ƒè™‘äº¤å‰ç¼–è¯‘å’Œ `CMAKE_SYSROOT`ã€‚
* **è§£å†³æ–¹æ¡ˆ**ï¼š
  1. **ï¼ˆæœ€ç»ˆé‡‡ç”¨ï¼‰** åœ¨å®¿ä¸»ï¼ˆWSLï¼‰åˆ›å»ºç¬¦å·é“¾æ¥ï¼Œæ¬ºéª— CMake çš„æ£€æŸ¥ï¼š
     ```bash
     sudo mkdir -p /usr/lib/aarch64-linux-gnu/mali
     sudo ln -s $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/mali/libEGL.so /usr/lib/aarch64-linux-gnu/mali/libEGL.so
     # (å¯èƒ½è¿˜éœ€è¦ GLESv2 ç­‰å…¶ä»–åº“)
     ```
  2. **ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰** ç›´æ¥ä¿®æ”¹ sysroot ä¸­çš„ `Qt5GuiConfigExtras.cmake` æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„ç»å¯¹è·¯å¾„æ‹¼æ¥ä¸Š `CMAKE_SYSROOT` å˜é‡ã€‚

### 2\. CMake Threads æ£€æµ‹å¤±è´¥

* **ç—‡çŠ¶**ï¼šå·²ä¿®å¤ `libEGL.so` é—®é¢˜åï¼Œ`cmake` æ¥ç€æŠ¥ `Could NOT find Threads`ã€‚
* **è°ƒæŸ¥**ï¼šæ£€æŸ¥ `CMakeError.log` å‘ç° `pthread_create` æµ‹è¯•å¤±è´¥ã€‚
* **åˆ†æ**ï¼šsysroot ä¸­æ˜æ˜å­˜åœ¨ `libpthread.so`ã€‚è¿™é€šå¸¸æ˜¯ CMake ç¼“å­˜äº†ä¸Šä¸€æ¬¡å¤±è´¥çš„é…ç½®ï¼ˆæ¯”å¦‚åœ¨ä¸Šä¸€æ¬¡é…ç½®ä¸­ï¼Œç¼–è¯‘å™¨æˆ– sysroot è·¯å¾„ä¸æ­£ç¡®ï¼‰ã€‚
* **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ é™¤ `build-rk3566` ç¼“å­˜ç›®å½•åé‡æ–°é…ç½®ã€‚
  ```bash
  rm -rf build-rk3566
  cmake -S . -B build-rk3566 ...
  ```

### 3\. `sqlite3` ä¾èµ–ç¼ºå¤±çš„åŒé‡è¡¥é½

* **ç—‡çŠ¶**ï¼šCMake é…ç½®é€šè¿‡ï¼Œä½†åœ¨ `cmake --build` ç¼–è¯‘ `history.cpp` æ—¶æŠ¥é”™ `fatal error: sqlite3.h: No such file or directory`ã€‚
* **è°ƒæŸ¥**ï¼š`find $RK3566_SYSROOT -name sqlite3.h` æœªå‘ç°ä»»ä½•æ–‡ä»¶ã€‚
* **åˆ†æ**ï¼šsysroot æ˜¯ä»æ¿ç«¯æå–çš„ï¼Œä½†æ¿ç«¯åªå®‰è£…äº† `libsqlite3-0`ï¼ˆè¿è¡Œåº“ï¼‰ï¼Œæ²¡æœ‰å®‰è£… `libsqlite3-dev`ï¼ˆå¼€å‘åŒ…ï¼‰ï¼Œå¯¼è‡´ sysroot ç¼ºå¤±å¤´æ–‡ä»¶å’Œ `.pc` æ–‡ä»¶ã€‚
* **å¤±è´¥å°è¯•**ï¼šæœ€åˆå°è¯•ä»æ¿ç«¯åŒæ­¥ï¼Œä½†å› æ¿ç«¯æ— ç½‘ç»œæ— æ³• `apt install`ã€‚
* **æœ€ç»ˆæ–¹æ¡ˆï¼ˆWSL å¤šæ¶æ„ï¼‰**ï¼š
  1. åœ¨ WSL ä¸­ä¸º `apt` å¢åŠ  `arm64` æ¶æ„æ”¯æŒï¼š`sudo dpkg --add-architecture arm64`ã€‚
  2. ä¿®æ”¹ `/etc/apt/sources.list`ï¼Œä¸º `amd64` æ·»åŠ  `[arch=amd64]` æ ‡è¯†ï¼Œå¹¶ä¸º `arm64` æ·»åŠ  `ubuntu-ports`ï¼ˆARM ä»“åº“ï¼‰æºã€‚
  3. `sudo apt update` è§£å†³ 404 å’Œä»“åº“å†²çªã€‚
  4. æˆåŠŸå®‰è£… ARM ç‰ˆå¼€å‘åŒ…ï¼š`sudo apt install libsqlite3-dev:arm64`ã€‚
  5. å°† WSL æœ¬åœ°çš„ ARM å¼€å‘æ–‡ä»¶åŒæ­¥åˆ° sysrootï¼š
     ```bash
     sudo rsync -a /usr/include/aarch64-linux-gnu/sqlite3*.h $RK3566_SYSROOT/usr/include/
     sudo rsync -a /usr/lib/aarch64-linux-gnu/libsqlite3.so* $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/
     sudo rsync -a /usr/lib/aarch64-linux-gnu/pkgconfig/sqlite3.pc $RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/pkgconfig/
     ```

```
deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
# deb [arch=amd64] https://librealsense.intel.com/Debian/apt-repo focal main

deb [arch=arm64] https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal main restricted universe multiverse
deb [arch=arm64] https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-updates main restricted universe multiverse
deb [arch=arm64] https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-backports main restricted universe multiverse
```

### 4\. Host Qt å·¥å…·æ³¨å…¥åŒ…è£…è„šæœ¬

* **ç—‡çŠ¶**ï¼š`sqlite3.h` ä¿®å¤åï¼Œ`cmake --build` ç«‹å³åœ¨ `AUTOMOC` é˜¶æ®µå¤±è´¥ï¼Œæç¤º `moc` æ‰§è¡Œé”™è¯¯ï¼Œæ—¥å¿—ä¸­æ˜¾ç¤ºä¸º `ELF Q@`ï¼ˆæ ¼å¼é”™è¯¯ï¼‰ã€‚
* **åˆ†æ**ï¼š`AUTOMOC`ï¼ˆä»¥åŠ `AUTORCC`/`AUTOUIC`ï¼‰æ˜¯**åœ¨æ„å»ºæ—¶ï¼ˆç¼–è¯‘æœºä¸Šï¼‰** è¿è¡Œçš„å·¥å…·ï¼Œç”¨äºç”Ÿæˆ C++ ä»£ç ã€‚CMake æ‰¾åˆ°äº† sysroot ä¸­çš„ `moc` (`$RK3566_SYSROOT/usr/lib/qt5/bin/moc`)ï¼Œä½†è¿™ä¸ª `moc` æ˜¯ ARM æ¶æ„çš„ ELF æ–‡ä»¶ï¼Œæ— æ³•åœ¨ x86\_64 æ¶æ„çš„ WSL ä¸Šæ‰§è¡Œã€‚
* **è§£å†³æ–¹æ¡ˆï¼ˆWrapper è„šæœ¬ï¼‰**ï¼š
  1. **å®‰è£…å®¿ä¸» (x86) å·¥å…·**ï¼š`sudo apt install qttools5-dev-tools`ã€‚è¿™ä¼šåœ¨ `/usr/lib/qt5/bin` æä¾›äº† x86\_64 çš„ `moc`, `rcc`, `uic`ã€‚
  2. **é‡å‘½å ARM å·¥å…·**ï¼š
     ```bash
     sudo mv $RK3566_SYSROOT/usr/lib/qt5/bin/moc $RK3566_SYSROOT/usr/lib/qt5/bin/moc.real
     # (rcc å’Œ uic åŒç†)
     ```
  3. **åˆ›å»ºåŒ…è£…è„šæœ¬**ï¼šåˆ›å»ºåŒåè„šæœ¬ `moc`ï¼Œå°†è°ƒç”¨è½¬å‘ç»™å®¿ä¸»å·¥å…·ã€‚
     ```bash
     #!/bin/bash
     # $RK3566_SYSROOT/usr/lib/qt5/bin/moc
     exec /usr/lib/qt5/bin/moc "$@"
     ```
  4. `sudo chmod +x` èµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™ã€‚
  5. æ¸…ç†ç¼“å­˜å¹¶é‡æ–°æ„å»ºï¼ŒCMake è°ƒç”¨çš„è·¯å¾„ä¸å˜ï¼Œä½†å®é™…æ‰§è¡Œçš„æ˜¯å®¿ä¸» x86 ç¨‹åºï¼Œ`AUTOMOC` æˆåŠŸã€‚

### 5\. RK æ¿ç«¯æ‰§è¡Œæƒé™â€œPermission deniedâ€

* **ç—‡çŠ¶**ï¼šç¼–è¯‘äº§ç‰© `FeiQChatroom` é€šè¿‡ U ç›˜æ‹·è´åˆ° RK æ¿çš„ `~/Desktop` ç›®å½•ã€‚`ldd` æ£€æŸ¥ä¾èµ–å®Œæ•´ï¼Œ`file` ç¡®è®¤æ˜¯ aarch64 ELFã€‚ä½†æ‰§è¡Œ `./FeiQChatroom` æŠ¥ `Permission denied`ã€‚
* **å¤±è´¥å°è¯•**ï¼šä½¿ç”¨äº† `chmod +X` (å¤§å†™ X) å°è¯•èµ‹äºˆæƒé™ï¼Œä½†æ— æ•ˆã€‚
* **åˆ†æ**ï¼š
  1. **æ–‡ä»¶ç³»ç»Ÿ**ï¼šU ç›˜ï¼ˆFAT/exFATï¼‰ä¸å­˜å‚¨ POSIX æƒé™ã€‚æ–‡ä»¶ä» U ç›˜ `cp` åˆ° ext4 æ¡Œé¢æ—¶ï¼Œé»˜è®¤æƒé™å¯èƒ½ä¸åŒ…å«æ‰§è¡Œä½ã€‚
  2. **`chmod` å‘½ä»¤**ï¼š`chmod +X` (å¤§å†™) ä»…åœ¨æ–‡ä»¶ *å·²ç»* å¯¹ *æŸä¸ª* ç”¨æˆ·å…·æœ‰æ‰§è¡Œæƒé™æ—¶ï¼ˆæˆ–å¯¹ç›®å½•ï¼‰æ‰æ·»åŠ æ‰§è¡Œæƒé™ã€‚å¯¹äºä¸€ä¸ªæ–°å¤åˆ¶çš„ã€å®Œå…¨æ²¡æœ‰æ‰§è¡Œä½çš„æ–‡ä»¶ï¼Œ`+X` æ˜¯æ— æ•ˆçš„ã€‚
* **è§£å†³æ–¹æ¡ˆ**ï¼šå¿…é¡»ä½¿ç”¨**å°å†™ `x`** æ¥æ·»åŠ æ‰§è¡Œæƒé™ã€‚
  ```bash
  # åœ¨ RK æ¿ä¸Šï¼Œç¡®ä¿æ–‡ä»¶å·²åœ¨ ext4 åˆ†åŒº (å¦‚ /home/...)
  cp /media/usb/FeiQChatroom ~/Desktop/

  # ä½¿ç”¨ chmod +x (å°å†™)
  chmod +x ~/Desktop/FeiQChatroom

  ./FeiQChatroom
  ```

### 6\. SDK è‡ªå¸¦ sysroot çš„ä¿®å¤å¤±è´¥ï¼ˆæ–°å¢è¯¦è§£ï¼‰

* **èƒŒæ™¯**ï¼šåœ¨å†³å®šä»æ¿ç«¯ç¦»çº¿æ‰“åŒ… sysroot ä¹‹å‰ï¼Œä¼˜å…ˆå°è¯•äº†ä½¿ç”¨ SDK æä¾›çš„ `rootfs.img`ã€‚
* **æ­¥éª¤**ï¼š
  1. è§£å‹æˆ–æŒ‚è½½ SDK æä¾›çš„ `Ubuntu20.04.3LTS_Firefly_..._rootfs.img` é•œåƒã€‚
  2. å°†å…¶è·¯å¾„è®¾ç½®ä¸º `RK3566_SYSROOT`ã€‚
* **ç—‡çŠ¶**ï¼š`cmake -S . -B build-rk3566 ...` ç«‹å³æŠ¥é”™ï¼Œ`CMakeLists.txt:13 (find_package)` å¤±è´¥ï¼Œæç¤º `Could not find a package configuration file provided by "Qt5"`ã€‚
* **è°ƒæŸ¥ä¸å¤±è´¥å°è¯•**ï¼š
  1. `find $RK3566_SYSROOT -name "Qt5Config.cmake"` æœªæ‰¾åˆ°ä»»ä½•æ–‡ä»¶ã€‚
  2. **å°è¯•ä¿®å¤ 1**ï¼šä» SDK çš„å…¶ä»–ç›®å½•ï¼ˆé `rootfs.img`ï¼‰é›¶æ˜ŸæŸ¥æ‰¾ï¼Œè¯•å›¾æ‰¾åˆ° `.cmake` æ–‡ä»¶å¹¶ `rsync` è¿› sysrootã€‚
  3. **å¤±è´¥**ï¼šå³ä½¿æ‰¾åˆ°äº†éƒ¨åˆ†æ–‡ä»¶ï¼Œé©¬ä¸ŠåˆæŠ¥ç¼ºå°‘ EGL é©±åŠ¨ï¼ˆå¦‚ `libEGL.so`ï¼‰ã€Mali åº“æˆ– `moc`/`rcc` ç­‰å·¥å…·ã€‚
  4. **å°è¯•ä¿®å¤ 2**ï¼šæ‰‹åŠ¨å¤åˆ¶ `qt5/bin` ç›®å½•ï¼Œä½†è¿™äº›æ˜¯ ARM ç‰ˆ ELFï¼Œå¯¼è‡´äº†åç»­çš„ "Host å·¥å…·æ— æ³•æ‰§è¡Œ" é—®é¢˜ã€‚
* **æœ€ç»ˆåˆ†æä¸å†³ç­–**ï¼š
  * **æ ¹å› **ï¼šSDK æä¾›çš„ `rootfs.img` æ˜¯ä¸€ä¸ª**è¿è¡Œæ—¶ (Runtime) é•œåƒ**ï¼Œå®ƒåªåŒ…å«è¿è¡Œç¨‹åºæ‰€éœ€çš„åŠ¨æ€åº“ï¼ˆå¦‚ `libQt5Core.so.5`ï¼‰ï¼Œè€Œä¸åŒ…å«**å¼€å‘ (Development)** æ‰€éœ€çš„å¤´æ–‡ä»¶ (`.h`)ã€CMake é…ç½®æ–‡ä»¶ (`.cmake`) æˆ– `pkgconfig` (`.pc`) æ–‡ä»¶ã€‚è¿™äº›å¼€å‘æ–‡ä»¶é€šå¸¸åœ¨ `qtbase5-dev` ç­‰ `-dev` åŒ…ä¸­ã€‚
  * **æœ€ä¼˜æ–¹æ³•**ï¼šæ”¾å¼ƒä¿®è¡¥ SDK é•œåƒã€‚æœ€å¯é ä¸”æœ€ç®€å•çš„æ–¹æ³•æ˜¯ï¼š**åœ¨ç›®æ ‡æ¿ä¸Š `apt install` æ‰€æœ‰å¿…éœ€çš„ `-dev` åŒ…ï¼ˆå¦‚ `qtbase5-dev`, `libsqlite3-dev`ï¼‰ï¼Œç„¶åä»è¯¥æ¿ä¸Šå®Œæ•´å¯¼å‡º sysroot**ã€‚è¿™ç¡®ä¿äº† sysroot ä¸ç›®æ ‡ç¯å¢ƒ 100% ä¸€è‡´ã€‚

---

## æ ¸å¿ƒé€»è¾‘é“¾æ¡å›é¡¾

1. **`CMakeLists.txt`**ï¼šå®šä¹‰é¡¹ç›®ï¼ˆ`project`ï¼‰ã€æŸ¥æ‰¾ä¾èµ–ï¼ˆ`find_package(Qt5 ...)`ã€`find_package(Threads ...)`ï¼‰ã€å®šä¹‰ç›®æ ‡ï¼ˆ`add_executable`/`add_library`ï¼‰å’Œé“¾æ¥ï¼ˆ`target_link_libraries`ï¼‰ã€‚å®ƒåªç®¡â€œè¦ä»€ä¹ˆâ€ï¼Œä¸ç®¡â€œåœ¨å“ªæ‰¾â€ã€‚
2. **`cmake/toolchains/rk3566.cmake` (å·¥å…·é“¾æ–‡ä»¶)**ï¼šè¿™æ˜¯äº¤å‰ç¼–è¯‘çš„æ ¸å¿ƒã€‚å®ƒé€šè¿‡ `-DCMAKE_TOOLCHAIN_FILE=...` ä¼ ç»™ CMakeï¼Œå‘Šè¯‰ CMakeï¼š
   * **`CMAKE_SYSTEM_NAME`**ï¼šç›®æ ‡æ˜¯ `Linux`ã€‚
   * **`CMAKE_C_COMPILER` / `CMAKE_CXX_COMPILER`**ï¼šä½¿ç”¨å“ªä¸ªäº¤å‰ç¼–è¯‘å™¨ï¼ˆå¦‚ `aarch64-linux-gnu-g++`ï¼‰ã€‚
   * **`CMAKE_SYSROOT`**ï¼šäº¤å‰ç¼–è¯‘çš„â€œæ ¹ç›®å½•â€åœ¨å“ªé‡Œã€‚
3. **`env/setup-rk3566.sh` (ç¯å¢ƒè„šæœ¬)**ï¼šè¿™æ˜¯ä¸€ä¸ªè¾…åŠ©è„šæœ¬ï¼Œç”¨äºè®¾ç½®**shell ç¯å¢ƒå˜é‡**ï¼Œä¸»è¦æ˜¯ä¸ºäº†è®©å·¥å…·é“¾æ–‡ä»¶å’Œç¼–è¯‘å™¨èƒ½æ‰¾åˆ°æ­£ç¡®çš„è·¯å¾„ã€‚
   * `export RK3566_SYSROOT=...`ï¼šè®¾ç½® sysroot è·¯å¾„ã€‚
   * `export PATH=...:$PATH`ï¼šå°†äº¤å‰ç¼–è¯‘å™¨çš„ `bin` ç›®å½•åŠ å…¥ `PATH`ã€‚
   * `export PKG_CONFIG_LIBDIR=...`ï¼šå‘Šè¯‰ `pkg-config` å» sysroot é‡ŒæŸ¥æ‰¾ `.pc` æ–‡ä»¶ã€‚
4. **Sysroot çš„è§’è‰²**ï¼šå®ƒæ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿç›®æ ‡æ¿æ ¹æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ã€‚å½“ `aarch64-linux-gnu-g++` ç¼–è¯‘æ—¶ï¼Œ`--sysroot=$RK3566_SYSROOT` é€‰é¡¹å‘Šè¯‰å®ƒï¼š
   * æŸ¥æ‰¾ `#include <sqlite3.h>` æ—¶ï¼Œå» `$RK3566_SYSROOT/usr/include/sqlite3.h` æ‰¾ã€‚
   * é“¾æ¥ `-lQt5Core` æ—¶ï¼Œå» `$RK3566_SYSROOT/usr/lib/aarch64-linux-gnu/libQt5Core.so` æ‰¾ã€‚
   * è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬**å¿…é¡»ä»æ¿ç«¯è·å–**ï¼šåªæœ‰æ¿ç«¯ `apt install` åçš„ç¯å¢ƒï¼Œæ‰åŒæ—¶æ‹¥æœ‰è¿è¡Œåº“ (`.so`) å’Œå¼€å‘æ–‡ä»¶ (`.h`, `.cmake`)ã€‚

---

## ç»éªŒæ€»ç»“

* **Sysroot å¿…é¡»æ˜¯â€œå¼€å‘ç‰ˆâ€**ï¼šSDK è‡ªå¸¦çš„ `rootfs` é•œåƒæ˜¯è¿è¡Œæ—¶ï¼Œç¼ºå°‘ `-dev` åŒ…ã€‚å¿…é¡»ä»å®‰è£…äº† `qtbase5-dev` ç­‰åŒ…çš„æ¿ç«¯æå– sysrootã€‚
* **`aarch64-linux-gnu` ç›®å½•æ˜¯å…³é”®**ï¼šåœ¨ Debian/Ubuntu ç³»ä¸­ï¼Œæ‰€æœ‰ç‰¹å®šæ¶æ„çš„åº“ã€å¤´æ–‡ä»¶ã€CMake é…ç½®éƒ½å­˜æ”¾åœ¨å¸¦æ¶æ„å‰ç¼€çš„ç›®å½•ï¼ˆå¦‚ `/usr/lib/aarch64-linux-gnu`ï¼‰ã€‚æ‰“åŒ… sysroot æ—¶å¦‚æœé—æ¼è¿™ä¸ªç›®å½•ï¼Œå°†å¯¼è‡´è¿é”æ€§ `find_package` å¤±è´¥ã€‚ï¼ˆè¯¦è§é™„å½•ï¼‰
* **Host å·¥å…· vs Target å·¥å…·**ï¼š`moc`/`rcc` æ˜¯åœ¨**æ„å»ºæ—¶**è¿è¡Œåœ¨**ç¼–è¯‘æœº**ä¸Šçš„ï¼ˆHostï¼‰ï¼Œå¿…é¡»æ˜¯ x86 ç‰ˆã€‚ç¼–è¯‘å™¨ `g++` æ˜¯ç”Ÿæˆ**ç›®æ ‡æœº**ä»£ç çš„ï¼ˆTargetï¼‰ï¼Œå¿…é¡»æ˜¯ `aarch64` ç‰ˆã€‚
* **æ¸…ç©º CMake ç¼“å­˜**ï¼šé‡åˆ° `FindThreads` å¤±è´¥æˆ–åˆ‡æ¢ç¼–è¯‘å™¨åï¼Œ**å¿…é¡»** `rm -rf build-dir`ã€‚
* **`chmod +x` (å°å†™)**ï¼šä» Windows/FAT åˆ†åŒºå¤åˆ¶æ–‡ä»¶åˆ° Linux åï¼Œå¿…é¡»ç”¨å°å†™ `+x` æ‰èƒ½æ­£ç¡®æ·»åŠ æ‰§è¡Œæƒé™ã€‚

---

## é™„å½•ï¼šSysroot æ ¸å¿ƒé—®é¢˜å¤ç›˜ï¼ˆ`aarch64-linux-gnu` ç›®å½•ï¼‰

è¿™æ¬¡è°ƒè¯•ä¸­ 80% çš„ Qt é”™è¯¯ï¼ˆ`Qt5Config.cmake` æ‰¾ä¸åˆ°ã€`libEGL.so` æ‰¾ä¸åˆ°ã€`qmake` æ‰¾ä¸åˆ°ã€`moc` æ‰¾ä¸åˆ°ï¼‰éƒ½æºäº sysroot æ‰“åŒ…æ—¶çš„ä¸€ä¸ªæ ¸å¿ƒè¯¯è§£ï¼š

* **é”™è¯¯çš„æ‰“åŒ…**ï¼šåªæ‰“åŒ…äº† `/usr/include/qt5` å’Œ `/usr/lib/qt5` è¿™ç§â€œé€šç”¨â€ç›®å½•ã€‚
* **æ­£ç¡®çš„ç»“æ„ (Debian/Ubuntu å¤šæ¶æ„)**ï¼š
  * Qt çš„ CMake é…ç½®æ–‡ä»¶åœ¨ï¼š`/usr/lib/aarch64-linux-gnu/cmake/Qt5`
  * Qt çš„åº“æ–‡ä»¶åœ¨ï¼š`/usr/lib/aarch64-linux-gnu/libQt5Core.so`
  * Qt çš„æ¶æ„ç›¸å…³å¤´æ–‡ä»¶/`mkspecs` åœ¨ï¼š`/usr/include/aarch64-linux-gnu/qt5`
  * Mali é©±åŠ¨ (EGL) åœ¨ï¼š`/usr/lib/aarch64-linux-gnu/mali`
* **å¤ç›˜**ï¼š
  1. åˆæ¬¡æ‰“åŒ…æ—¶é—æ¼äº† `aarch64-linux-gnu` ç›®å½•ï¼Œå¯¼è‡´ `find_package(Qt5)` å¤±è´¥ã€‚
  2. åç»­ä¸ºäº†ä¿®å¤ï¼Œ**é’ˆå¯¹æ€§åœ°** `rsync` æ‹·è´ `qmake`ã€`moc`ã€`libEGL.so` ç­‰ã€‚
  3. è¿™æ˜¯ä¸€ç§â€œæ‰“è¡¥ä¸â€è¡Œä¸ºï¼Œè™½ç„¶æœ€ç»ˆè§£å†³äº†é—®é¢˜ï¼Œä½†æ ¹æºåœ¨äº**ç¬¬ä¸€æ¬¡æ‰“åŒ… sysroot æ—¶å°±åº”è¯¥åŒ…å«æ•´ä¸ª `/usr/lib/aarch64-linux-gnu` å’Œ `/usr/include/aarch64-linux-gnu` ç›®å½•**ã€‚
* **æœ€ä½³å®è·µæ‰“åŒ…å‘½ä»¤**ï¼š
  ```bash
  # åœ¨æ¿ç«¯æ‰§è¡Œ
  sudo tar -cpf /tmp/rk3566-sysroot-$(date +%Y%m%d).tar \
      --numeric-owner --xattrs --acls \
      -C / \
      usr/lib usr/include usr/bin usr/share \
      lib etc/ld.so.conf etc/ld.so.conf.d etc/ld.so.cache
  ```

  ï¼ˆè¿™ä¸ªå‘½ä»¤ä¼šå®Œæ•´åœ°æŠŠ `usr/lib/aarch64-linux-gnu` ç­‰æ‰€æœ‰å¤šæ¶æ„ç›®å½•ä¸€æ¬¡æ€§æ‰“åŒ…ã€‚ï¼‰

## é™æ€ç¼–è¯‘å¯èƒ½æ€§

- ç›®æ ‡ï¼šæŠŠå½“å‰çš„ aarch64 äº¤å‰æ„å»ºä»â€œåŠ¨æ€é“¾æ¥ Qt ä¸ä¾èµ–â€æ”¹æˆâ€œç”Ÿæˆå®Œå…¨é™æ€æˆ–åŠé™æ€ï¼ˆQt ç­‰ä¹Ÿæ‰“åŒ…è¿›äºŒè¿›åˆ¶ï¼‰â€ã€‚
- å…³é”®å˜æ›´ï¼š
  - **ä¾èµ–èµ„äº§**ï¼šç°æœ‰ sysroot åªæœ‰ `.so`ï¼Œéœ€è¦å®Œæ•´çš„ `.a` ç‰ˆ Qt5ï¼ˆå« QtGui/Widgets/Network ç­‰æ¨¡å—ï¼‰ã€`libsqlite3.a`ã€`libssl.a` ç­‰ç¬¬ä¸‰æ–¹é™æ€åº“ã€‚å‘è¡Œç‰ˆé»˜è®¤ä¸æä¾›ï¼Œéœ€è¦åœ¨æ¿ç«¯æˆ– WSL é‡æ–°ç¼–è¯‘ Qt/SQLite/OpenSSLï¼Œå¹¶æŠŠ `.a` + å¯¹åº”å¤´æ–‡ä»¶åŒæ­¥è¿› sysrootã€‚
  - **å·¥å…·é“¾é…ç½®**ï¼šåœ¨ `cmake/toolchains/rk3566.cmake` ä¸­è®¾å®š `set(CMAKE_FIND_LIBRARY_SUFFIXES .a)` æˆ–åœ¨é¡¹ç›® `CMakeLists.txt` ä½¿ç”¨ `set(BUILD_SHARED_LIBS OFF)`ï¼Œå¹¶åœ¨ç›®æ ‡ä¸Š `target_link_options(FeiQChatroom PRIVATE -static -static-libstdc++ -static-libgcc)`ï¼ˆæˆ– `CMAKE_EXE_LINKER_FLAGS`). æ³¨æ„ glibc å…¨é™æ€ä¼šè§¦å‘ NSS/locale ç­‰é—®é¢˜ï¼Œé€šå¸¸é€‰æ‹©â€œQt é™æ€ + glibc åŠ¨æ€â€æˆ–è¿ç§»åˆ° muslã€‚
  - **Qt é™æ€ç­–ç•¥**ï¼š
    1. é‡æ–°æ„å»º Qt 5.12.8ï¼š`./configure -static -prefix ... -no-openssl` ç­‰ï¼ŒæŒ‡å®š `-device-option CROSS_COMPILE` ä¸ `-sysroot`ã€‚
    2. åœ¨ `CMAKE_PREFIX_PATH` ä¸­æ”¹æŒ‡å‘æ–° Qt çš„ `lib/cmake/Qt5`, å¹¶ä¿è¯ `Qt5::Gui` ç­‰æŒ‡å‘ `.a`ã€‚
    3. æ’ä»¶ï¼šé™æ€ Qt éœ€è¦ `-qt-freetype -qt-harfbuzz` ç­‰å†…ç½®æ›¿ä»£ï¼ŒåŒæ—¶æŠŠ `platforms`ã€`styles` æ’ä»¶ä»¥é™æ€æ–¹å¼ç¼–è¯‘è¿›ä¸»ç¨‹åºï¼ˆ`QTPLUGIN += qxcb qminimal` ç­‰ï¼Œæˆ–åœ¨ CMake `qt5_add_resources` + `QT_FORCE_ASSERTS`ï¼‰ã€‚
  - **Third-party ç»„ä»¶**ï¼š
    - å¦‚æœç»§ç»­ä½¿ç”¨ç³»ç»Ÿ OpenSSLã€zlib ç­‰ï¼Œéœ€å‡†å¤‡ç›¸åº” `.a`ã€‚
    - `libEGL`/`Mali` é©±åŠ¨é€šå¸¸ä»…æœ‰ `.so`ï¼Œå…¨é™æ€ GUI å‡ ä¹ä¸å¯è¡Œï¼›æŠ˜ä¸­æ–¹æ¡ˆæ˜¯ç»´æŒè¿™äº›åŠ¨æ€åº“ï¼Œå…¶ä»–ä¾èµ–é™æ€åŒ–ã€‚
  - **CMake é€‚é…**ï¼š
    - åœ¨ `CMakeLists.txt` ä¸­ç¡®ä¿æ‰€æœ‰ `feaqlib` å­é¡¹ç›®ä¹Ÿä½¿ç”¨é™æ€åº“ï¼ˆå¯èƒ½éœ€è¦æŠŠ `add_library(feiqlib SHARED ...)` æ”¹ä¸º `STATIC` æˆ–é¢å¤–æ„å»º static ç‰ˆæœ¬ï¼‰ã€‚
    - æ£€æŸ¥ç”Ÿæˆçš„ `QRC`/`MOC` ä¸å—å½±å“ï¼›ä½†é“¾æ¥å‘½ä»¤éœ€æ‰‹åŠ¨è¿½åŠ æ’ä»¶å¯¹è±¡ã€‚
  - **å‘å¸ƒä¸è®¸å¯**ï¼šQt é™æ€é“¾æ¥è§¦åŠ LGPL æ¡æ¬¾ï¼Œè‹¥ä¸å¼€æºä¿®æ”¹ç‰ˆæœ¬éœ€å•†ä¸šè®¸å¯è¯ï¼›ç¡®ä¿ç¬¦åˆè®¸å¯è¦æ±‚ã€‚
  - **è°ƒè¯•ä¸å°ºå¯¸**ï¼šé™æ€äºŒè¿›åˆ¶ä¼šæ˜¾è‘—å¢å¤§ï¼Œstrip å‰åå·®å¼‚å¤§ï¼›é™æ€ glibc åœ¨ DNS/NSS ä¸Šä»éœ€ nsswitch.conf ç­‰æ–‡ä»¶ã€‚

å»ºè®®å…ˆç¡®è®¤æ˜¯å¦çœŸéœ€è¦å®Œå…¨é™æ€ï¼šè‹¥åªæ˜¯ä¸ºäº†å‡å°‘éƒ¨ç½²æ–‡ä»¶æ•°é‡ï¼Œå¯æ”¹ç”¨ `linuxdeployqt` å¼â€œåŠé™æ€â€æ‰“åŒ…ï¼ŒæŠŠ `.so` æ”¾åŒç›®å½•å³å¯ï¼Œçœå»é‡ç¼–è¯‘ Qt çš„æˆæœ¬ã€‚
